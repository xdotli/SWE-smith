{
    "cost": 0.10895,
    "rewrites": {
        "dubinc__dub.main/apps/web/tests/rewards/lead-reward.test.ts": {
            "output": "import { TrackLeadResponse } from \"@/lib/types\";\nimport { randomCustomer } from \"tests/utils/helpers\";\nimport {\n  E2E_LEAD_REWARD,\n  E2E_PARTNERS,\n  E2E_TRACK_CLICK_HEADERS,\n} from \"tests/utils/resource\";\nimport { verifyCommission } from \"tests/utils/verify-commission\";\nimport { describe, expect, test } from \"vitest\";\nimport { IntegrationHarness } from \"../utils/integration\";\n\ndescribe.concurrent(\"Lead rewards\", async () => {\n  const h = new IntegrationHarness();\n  const { http } = await h.init();\n\n  test(\"when {Partner} {Country} is {US}\", async () => {\n    // Track the click\n    const clickResponse = await http.post<{ clickId: string }>({\n      path: \"/track/click\",\n      headers: E2E_TRACK_CLICK_HEADERS,\n      body: {\n        ...E2E_PARTNERS[0].shortLink,\n      },\n    });\n\n    expect(clickResponse.status).toEqual(200);\n\n    const clickId = clickResponse.data.clickId;\n    const customer = randomCustomer();\n\n    // Track the lead\n    const trackLeadResponse = await http.post<TrackLeadResponse>({\n      path: \"/track/lead\",\n      body: {\n        clickId,\n        eventName: \"Signup\",\n        customerExternalId: customer.externalId,\n        customerName: customer.name,\n        customerEmail: customer.email,\n        customerAvatar: customer.avatar,\n      },\n    });\n\n    expect(trackLeadResponse.status).toEqual(200);\n\n    // Verify the commission\n    await verifyCommission({\n      http,\n      customerExternalId: customer.externalId,\n      expectedEarnings: E2E_LEAD_REWARD.modifiers[0].amountInCents,\n    });\n  });\n\n  test(\"when {Partner} {Country} is not {US}\", async () => {\n    // Track the click\n    const clickResponse = await http.post<{ clickId: string }>({\n      path: \"/track/click\",\n      headers: E2E_TRACK_CLICK_HEADERS,\n      body: {\n        ...E2E_PARTNERS[1].shortLink,\n      },\n    });\n\n    expect(clickResponse.status).toEqual(200);\n\n    const clickId = clickResponse.data.clickId;\n    const customer = randomCustomer();\n\n    // Track the lead\n    const trackLeadResponse = await http.post<TrackLeadResponse>({\n      path: \"/track/lead\",\n      body: {\n        clickId,\n        eventName: \"Signup\",\n        customerExternalId: customer.externalId,\n        customerName: customer.name,\n        customerEmail: customer.email,\n        customerAvatar: customer.avatar,\n      },\n    });\n\n    expect(trackLeadResponse.status).toEqual(200);\n\n    // Verify the commission\n    await verifyCommission({\n      http,\n      customerExternalId: customer.externalId,\n      expectedEarnings: E2E_LEAD_REWARD.amountInCents,\n    });\n  });\n});",
            "output_extracted": "import { TrackLeadResponse } from \"@/lib/types\";\nimport { randomCustomer } from \"tests/utils/helpers\";\nimport {\n  E2E_LEAD_REWARD,\n  E2E_PARTNERS,\n  E2E_TRACK_CLICK_HEADERS,\n} from \"tests/utils/resource\";\nimport { verifyCommission } from \"tests/utils/verify-commission\";\nimport { describe, expect, test } from \"vitest\";\nimport { IntegrationHarness } from \"../utils/integration\";\n\ndescribe.concurrent(\"Lead rewards\", async () => {\n  const h = new IntegrationHarness();\n  const { http } = await h.init();\n\n  test(\"when {Partner} {Country} is {US}\", async () => {\n    // Track the click\n    const clickResponse = await http.post<{ clickId: string }>({\n      path: \"/track/click\",\n      headers: E2E_TRACK_CLICK_HEADERS,\n      body: {\n        ...E2E_PARTNERS[0].shortLink,\n      },\n    });\n\n    expect(clickResponse.status).toEqual(200);\n\n    const clickId = clickResponse.data.clickId;\n    const customer = randomCustomer();\n\n    // Track the lead\n    const trackLeadResponse = await http.post<TrackLeadResponse>({\n      path: \"/track/lead\",\n      body: {\n        clickId,\n        eventName: \"Signup\",\n        customerExternalId: customer.externalId,\n        customerName: customer.name,\n        customerEmail: customer.email,\n        customerAvatar: customer.avatar,\n      },\n    });\n\n    expect(trackLeadResponse.status).toEqual(200);\n\n    // Verify the commission\n    await verifyCommission({\n      http,\n      customerExternalId: customer.externalId,\n      expectedEarnings: E2E_LEAD_REWARD.modifiers[0].amountInCents,\n    });\n  });\n\n  test(\"when {Partner} {Country} is not {US}\", async () => {\n    // Track the click\n    const clickResponse = await http.post<{ clickId: string }>({\n      path: \"/track/click\",\n      headers: E2E_TRACK_CLICK_HEADERS,\n      body: {\n        ...E2E_PARTNERS[1].shortLink,\n      },\n    });\n\n    expect(clickResponse.status).toEqual(200);\n\n    const clickId = clickResponse.data.clickId;\n    const customer = randomCustomer();\n\n    // Track the lead\n    const trackLeadResponse = await http.post<TrackLeadResponse>({\n      path: \"/track/lead\",\n      body: {\n        clickId,\n        eventName: \"Signup\",\n        customerExternalId: customer.externalId,\n        customerName: customer.name,\n        customerEmail: customer.email,\n        customerAvatar: customer.avatar,\n      },\n    });\n\n    expect(trackLeadResponse.status).toEqual(200);\n\n    // Verify the commission\n    await verifyCommission({\n      http,\n      customerExternalId: customer.externalId,\n      expectedEarnings: E2E_LEAD_REWARD.amountInCents,\n    });\n  });\n});",
            "cost": 0.030155
        },
        "dubinc__dub.main/apps/web/tests/utils/resource.ts": {
            "output": "export const E2E_USER_ID = \"clxz1q7c7000hbqx5ckv4r82h\";\nexport const E2E_USER_ID_MEMBER = \"user_1KAERYAJ10MDM56EB9XPX4ZZ8\"; // for member user tests\nexport const E2E_WORKSPACE_ID = \"ws_clrei1gld0002vs9mzn93p8ik\";\n\nexport const E2E_LINK = {\n  domain: \"dub.sh\",\n  key: \"test-click-tracking\",\n  url: \"https://github.com/dubinc\",\n};\n\nexport const E2E_TRACK_CLICK_HEADERS = {\n  referer: \"https://dub.co\",\n  \"User-Agent\":\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\",\n};\n\nexport const E2E_TAG = {\n  id: \"clvkopm8b0009nf98azsp9epk\",\n  name: \"E2E Tests (DO NOT DELETE)\",\n  color: \"red\",\n};\n\nexport const E2E_TAG_2 = {\n  id: \"tag_sfaXFOt0kFLtEV3Z5wtywbTl\",\n  name: \"E2E Tests 2 (DO NOT DELETE)\",\n  color: \"blue\",\n};\n\nexport const E2E_CUSTOMER_ID = \"cm25onzuv0001s1bbxchrc0ae\";\nexport const E2E_CUSTOMER_EXTERNAL_ID = \"cus_jTrfVKYN3Buc3F80JoqBiY0g\";\nexport const E2E_WEBHOOK_ID = \"wh_MHR7sZXXtZ7keBaNYZ30rQ0v\";\n\n// Folders specific\nexport const E2E_WRITE_ACCESS_FOLDER_ID = \"fold_1JP8FMYP08RGJKJB3S4DNYH13\"; // Folder with write access\nexport const E2E_READ_ONLY_FOLDER_ID = \"fold_1JP8FN462884CA6JJCVPAHAD4\"; // Folder with read-only access\nexport const E2E_NO_ACCESS_FOLDER_ID = \"fold_1JRZXGNNYWDA5QTT8CVDB3M23\"; // Folder with no access\nexport const E2E_READ_ONLY_FOLDER_LINK_ID = \"link_1KAESR5Z733716RTT4E1RSTW6\"; // A link in read-only folder\nexport const E2E_NO_ACCESS_FOLDER_LINK_ID = \"link_1KAESQ2Z6Q35WDV5NGSEVPFB0\"; // A link in no access folder\n\n// Rewards specific\nexport const E2E_CUSTOMER_EXTERNAL_ID_2 = \"cus_pqc8qRtofpu6ZqvutyNDGAU2\";\nexport const E2E_SALE_REWARD = {\n  id: \"rw_1JYPP77NNDG6TVPAJDKNZREQN\",\n  event: \"sale\",\n  type: \"flat\",\n  amountInCents: 1000,\n  modifiers: [\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"premiumProductId\",\n          entity: \"sale\",\n          operator: \"equals_to\",\n          attribute: \"productId\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 3000,\n    },\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: 15000,\n          entity: \"sale\",\n          operator: \"greater_than\",\n          attribute: \"amount\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 5000,\n    },\n    {\n      type: \"percentage\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"US\",\n          entity: \"customer\",\n          operator: \"equals_to\",\n          attribute: \"country\",\n        },\n      ],\n      maxDuration: null,\n      amountInPercentage: 10,\n    },\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"CA\",\n          entity: \"customer\",\n          operator: \"equals_to\",\n          attribute: \"country\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 50,\n    },\n  ],\n};\n\nexport const E2E_LEAD_REWARD = {\n  id: \"rw_1K82ESAT4YPY0STR20GKXZ7DR\",\n  event: \"lead\",\n  type: \"flat\",\n  amountInCents: 100,\n  modifiers: [\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"US\",\n          entity: \"partner\",\n          operator: \"equals_to\",\n          attribute: \"country\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 200,\n    },\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"US\",\n          entity: \"customer\",\n          operator: \"equals_to\",\n          attribute: \"country\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 400,\n    },\n  ],\n};\n\n// Discounts specific\nexport const E2E_CUSTOMER_WITH_DISCOUNT = {\n  id: \"cus_pNGuZQJrAKjzttQTZMI4a46y\",\n  externalId: \"cus_PowZhxHqUvN8MSdszEElqsUx\",\n  email: \"rural.yellow.takin@example.com\",\n};\n\nexport const E2E_DISCOUNT = {\n  id: \"disc_1K2E253814K7TA6YRKA86XMX5\",\n  amount: 30,\n  type: \"percentage\",\n  maxDuration: 3,\n  couponId: \"XZuejd0Q\",\n  couponTestId: \"2NMXz81x\",\n  description: null,\n};\n\n// Program\nexport const E2E_PROGRAM = {\n  id: \"prog_CYCu7IMAapjkRpTnr8F1azjN\",\n  domain: \"getacme.link\",\n};\n\nexport const E2E_PARTNER = {\n  id: \"pn_H4TB2V5hDIjpqB7PwrxESoY3\",\n  email: \"steven@dub.co\",\n  tenantId: \"4149092f-7265-4002-98d9-da9f8e67e1fb\",\n};\n\nexport const E2E_PARTNER_GROUP = {\n  id: \"grp_1K2E25381GVMG7HHM057TB92F\",\n  url: \"https://acme.dub.sh/\",\n};\n\nexport const E2E_PARTNERS = [\n  {\n    id: \"pn_NNG3YjwhLhA7nCZSaXeLIsWu\",\n    country: \"US\",\n    shortLink: {\n      domain: \"getacme.link\",\n      key: \"marvin\",\n    },\n  },\n  {\n    id: \"pn_1K8ND11BZ4XPEX39QX3YMBGY0\",\n    country: \"SG\",\n    shortLink: {\n      domain: \"getacme.link\",\n      key: \"kiran-e2e-1\",\n    },\n  },\n] as const;\n\nexport const E2E_CUSTOMERS = [\n  {\n    id: \"cus_1K82FYFF7RANMCGRHRGMWDNEC\",\n    externalId: \"cus_LnZbkb8boLsOn1YGLPxZGZMU\",\n    country: \"SG\",\n  },\n  {\n    id: \"cus_1K86CG1DZFW8EMSSWXX4AVZFA\",\n    externalId: \"cus_vq3UgXINHS99MIon8vNvAO1n\",\n    country: \"CA\",\n  },\n] as const;\n\nexport const E2E_FRAUD_PARTNER = {\n  id: \"pn_1K8ND11BZ4XPEX39QX3YMBGY0\",\n  email: \"kiran+e2e+1@dub.co\",\n  links: {\n    customerEmailMatch: {\n      domain: \"getacme.link\",\n      key: \"fraud-customer-match\",\n    },\n    customerEmailSuspiciousDomain: {\n      domain: \"getacme.link\",\n      key: \"fraud-customer-suspicious\",\n    },\n    referralSourceBanned: {\n      domain: \"getacme.link\",\n      key: \"fraud-referral-source-banned\",\n    },\n    paidTrafficDetected: {\n      domain: \"getacme.link\",\n      key: \"fraud-paid-traffic\",\n    },\n  },\n} as const;\n\nexport const E2E_FRAUD_REFERRAL_SOURCE_BANNED_DOMAIN =\n  \"test-hostname-for-referral-source-banned-do-not-delete.com\";",
            "output_extracted": "export const E2E_USER_ID = \"clxz1q7c7000hbqx5ckv4r82h\";\nexport const E2E_USER_ID_MEMBER = \"user_1KAERYAJ10MDM56EB9XPX4ZZ8\"; // for member user tests\nexport const E2E_WORKSPACE_ID = \"ws_clrei1gld0002vs9mzn93p8ik\";\n\nexport const E2E_LINK = {\n  domain: \"dub.sh\",\n  key: \"test-click-tracking\",\n  url: \"https://github.com/dubinc\",\n};\n\nexport const E2E_TRACK_CLICK_HEADERS = {\n  referer: \"https://dub.co\",\n  \"User-Agent\":\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\",\n};\n\nexport const E2E_TAG = {\n  id: \"clvkopm8b0009nf98azsp9epk\",\n  name: \"E2E Tests (DO NOT DELETE)\",\n  color: \"red\",\n};\n\nexport const E2E_TAG_2 = {\n  id: \"tag_sfaXFOt0kFLtEV3Z5wtywbTl\",\n  name: \"E2E Tests 2 (DO NOT DELETE)\",\n  color: \"blue\",\n};\n\nexport const E2E_CUSTOMER_ID = \"cm25onzuv0001s1bbxchrc0ae\";\nexport const E2E_CUSTOMER_EXTERNAL_ID = \"cus_jTrfVKYN3Buc3F80JoqBiY0g\";\nexport const E2E_WEBHOOK_ID = \"wh_MHR7sZXXtZ7keBaNYZ30rQ0v\";\n\n// Folders specific\nexport const E2E_WRITE_ACCESS_FOLDER_ID = \"fold_1JP8FMYP08RGJKJB3S4DNYH13\"; // Folder with write access\nexport const E2E_READ_ONLY_FOLDER_ID = \"fold_1JP8FN462884CA6JJCVPAHAD4\"; // Folder with read-only access\nexport const E2E_NO_ACCESS_FOLDER_ID = \"fold_1JRZXGNNYWDA5QTT8CVDB3M23\"; // Folder with no access\nexport const E2E_READ_ONLY_FOLDER_LINK_ID = \"link_1KAESR5Z733716RTT4E1RSTW6\"; // A link in read-only folder\nexport const E2E_NO_ACCESS_FOLDER_LINK_ID = \"link_1KAESQ2Z6Q35WDV5NGSEVPFB0\"; // A link in no access folder\n\n// Rewards specific\nexport const E2E_CUSTOMER_EXTERNAL_ID_2 = \"cus_pqc8qRtofpu6ZqvutyNDGAU2\";\nexport const E2E_SALE_REWARD = {\n  id: \"rw_1JYPP77NNDG6TVPAJDKNZREQN\",\n  event: \"sale\",\n  type: \"flat\",\n  amountInCents: 1000,\n  modifiers: [\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"premiumProductId\",\n          entity: \"sale\",\n          operator: \"equals_to\",\n          attribute: \"productId\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 3000,\n    },\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: 15000,\n          entity: \"sale\",\n          operator: \"greater_than\",\n          attribute: \"amount\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 5000,\n    },\n    {\n      type: \"percentage\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"US\",\n          entity: \"customer\",\n          operator: \"equals_to\",\n          attribute: \"country\",\n        },\n      ],\n      maxDuration: null,\n      amountInPercentage: 10,\n    },\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"CA\",\n          entity: \"customer\",\n          operator: \"equals_to\",\n          attribute: \"country\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 50,\n    },\n  ],\n};\n\nexport const E2E_LEAD_REWARD = {\n  id: \"rw_1K82ESAT4YPY0STR20GKXZ7DR\",\n  event: \"lead\",\n  type: \"flat\",\n  amountInCents: 100,\n  modifiers: [\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"US\",\n          entity: \"partner\",\n          operator: \"equals_to\",\n          attribute: \"country\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 200,\n    },\n    {\n      type: \"flat\",\n      operator: \"AND\",\n      conditions: [\n        {\n          value: \"US\",\n          entity: \"customer\",\n          operator: \"equals_to\",\n          attribute: \"country\",\n        },\n      ],\n      maxDuration: null,\n      amountInCents: 400,\n    },\n  ],\n};\n\n// Discounts specific\nexport const E2E_CUSTOMER_WITH_DISCOUNT = {\n  id: \"cus_pNGuZQJrAKjzttQTZMI4a46y\",\n  externalId: \"cus_PowZhxHqUvN8MSdszEElqsUx\",\n  email: \"rural.yellow.takin@example.com\",\n};\n\nexport const E2E_DISCOUNT = {\n  id: \"disc_1K2E253814K7TA6YRKA86XMX5\",\n  amount: 30,\n  type: \"percentage\",\n  maxDuration: 3,\n  couponId: \"XZuejd0Q\",\n  couponTestId: \"2NMXz81x\",\n  description: null,\n};\n\n// Program\nexport const E2E_PROGRAM = {\n  id: \"prog_CYCu7IMAapjkRpTnr8F1azjN\",\n  domain: \"getacme.link\",\n};\n\nexport const E2E_PARTNER = {\n  id: \"pn_H4TB2V5hDIjpqB7PwrxESoY3\",\n  email: \"steven@dub.co\",\n  tenantId: \"4149092f-7265-4002-98d9-da9f8e67e1fb\",\n};\n\nexport const E2E_PARTNER_GROUP = {\n  id: \"grp_1K2E25381GVMG7HHM057TB92F\",\n  url: \"https://acme.dub.sh/\",\n};\n\nexport const E2E_PARTNERS = [\n  {\n    id: \"pn_NNG3YjwhLhA7nCZSaXeLIsWu\",\n    country: \"US\",\n    shortLink: {\n      domain: \"getacme.link\",\n      key: \"marvin\",\n    },\n  },\n  {\n    id: \"pn_1K8ND11BZ4XPEX39QX3YMBGY0\",\n    country: \"SG\",\n    shortLink: {\n      domain: \"getacme.link\",\n      key: \"kiran-e2e-1\",\n    },\n  },\n] as const;\n\nexport const E2E_CUSTOMERS = [\n  {\n    id: \"cus_1K82FYFF7RANMCGRHRGMWDNEC\",\n    externalId: \"cus_LnZbkb8boLsOn1YGLPxZGZMU\",\n    country: \"SG\",\n  },\n  {\n    id: \"cus_1K86CG1DZFW8EMSSWXX4AVZFA\",\n    externalId: \"cus_vq3UgXINHS99MIon8vNvAO1n\",\n    country: \"CA\",\n  },\n] as const;\n\nexport const E2E_FRAUD_PARTNER = {\n  id: \"pn_1K8ND11BZ4XPEX39QX3YMBGY0\",\n  email: \"kiran+e2e+1@dub.co\",\n  links: {\n    customerEmailMatch: {\n      domain: \"getacme.link\",\n      key: \"fraud-customer-match\",\n    },\n    customerEmailSuspiciousDomain: {\n      domain: \"getacme.link\",\n      key: \"fraud-customer-suspicious\",\n    },\n    referralSourceBanned: {\n      domain: \"getacme.link\",\n      key: \"fraud-referral-source-banned\",\n    },\n    paidTrafficDetected: {\n      domain: \"getacme.link\",\n      key: \"fraud-paid-traffic\",\n    },\n  },\n} as const;\n\nexport const E2E_FRAUD_REFERRAL_SOURCE_BANNED_DOMAIN =\n  \"test-hostname-for-referral-source-banned-do-not-delete.com\";",
            "cost": 0.078795
        }
    },
    "recover_status": "success",
    "instance_ref": {
        "instance_id": "dubinc__dub.main.3027",
        "repo": "dubinc/dub",
        "base_commit": "5d86b60093e63dc01ab8ba41a7d06bd46c92cfba",
        "head_commit": "64e5bb30efd3d8cec74e2f9fd53e1b3ff8b6a291",
        "title": "Update rewards tests",
        "merged_at": "2025-10-29T17:23:30Z",
        "html_url": "https://github.com/dubinc/dub/pull/3027",
        "test_files": [
            "apps/web/tests/rewards/lead-reward.test.ts"
        ],
        "code_files": [
            "apps/web/tests/utils/resource.ts"
        ],
        "total_changes": 16,
        "num_files": 2,
        "pull_number": 3027,
        "patch": "diff --git a/apps/web/tests/rewards/lead-reward.test.ts b/apps/web/tests/rewards/lead-reward.test.ts\nindex 990167233e9..95456359ec5 100644\n--- a/apps/web/tests/rewards/lead-reward.test.ts\n+++ b/apps/web/tests/rewards/lead-reward.test.ts\n@@ -13,7 +13,7 @@ describe.concurrent(\"Lead rewards\", async () => {\n   const h = new IntegrationHarness();\n   const { http } = await h.init();\n \n-  test(\"when {Partner} {Country} is {US}\", async () => {\n+  test(\"when customer country is US and partner country is US\", async () => {\n     // Track the click\n     const clickResponse = await http.post<{ clickId: string }>({\n       path: \"/track/click\",\n@@ -47,11 +47,11 @@ describe.concurrent(\"Lead rewards\", async () => {\n     await verifyCommission({\n       http,\n       customerExternalId: customer.externalId,\n-      expectedEarnings: E2E_LEAD_REWARD.modifiers[0].amountInCents,\n+      expectedEarnings: E2E_LEAD_REWARD.modifiers[1].amountInCents,\n     });\n   });\n \n-  test(\"when {Partner} {Country} is not {US}\", async () => {\n+  test(\"when customer country is US and partner country is not US\", async () => {\n     // Track the click\n     const clickResponse = await http.post<{ clickId: string }>({\n       path: \"/track/click\",\n@@ -85,7 +85,7 @@ describe.concurrent(\"Lead rewards\", async () => {\n     await verifyCommission({\n       http,\n       customerExternalId: customer.externalId,\n-      expectedEarnings: E2E_LEAD_REWARD.amountInCents,\n+      expectedEarnings: E2E_LEAD_REWARD.modifiers[0].amountInCents,\n     });\n   });\n });\ndiff --git a/apps/web/tests/utils/resource.ts b/apps/web/tests/utils/resource.ts\nindex 6aefc236eb2..2114f8b2454 100644\n--- a/apps/web/tests/utils/resource.ts\n+++ b/apps/web/tests/utils/resource.ts\n@@ -115,7 +115,7 @@ export const E2E_LEAD_REWARD = {\n       conditions: [\n         {\n           value: \"US\",\n-          entity: \"partner\",\n+          entity: \"customer\",\n           operator: \"equals_to\",\n           attribute: \"country\",\n         },\n@@ -129,13 +129,13 @@ export const E2E_LEAD_REWARD = {\n       conditions: [\n         {\n           value: \"US\",\n-          entity: \"customer\",\n+          entity: \"partner\",\n           operator: \"equals_to\",\n           attribute: \"country\",\n         },\n       ],\n-      maxDuration: null,\n-      amountInCents: 400,\n+      maxDuration: 0,\n+      amountInCents: 300,\n     },\n   ],\n };\n",
        "pr_mirror": "dubinc__dub.main"
    }
}