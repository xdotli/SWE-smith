{"repo": "axios/axios", "pull_number": 7229, "instance_id": "axios__axios.ef36347f.7229", "issue_numbers": [], "base_commit": "ef36347f", "patch": "diff --git a/lib/adapters/http.js b/lib/adapters/http.js\nindex 28d3d2bb64..dfa6386d32 100755\n--- a/lib/adapters/http.js\n+++ b/lib/adapters/http.js\n@@ -816,8 +816,6 @@ export default isHttpAdapterSupported && function httpAdapter(config) {\n \n     // Handle errors\n     req.on('error', function handleRequestError(err) {\n-      // @todo remove\n-      // if (req.aborted && err.code !== AxiosError.ERR_FR_TOO_MANY_REDIRECTS) return;\n       reject(AxiosError.from(err, null, config, req));\n     });\n \n", "test_patch": "", "problem_statement": "", "hints_text": "", "created_at": "2025-11-17T06:47:46Z"}
{"repo": "axios/axios", "pull_number": 7218, "instance_id": "axios__axios.ef36347f.7218", "issue_numbers": ["7208"], "base_commit": "ef36347f", "patch": "diff --git a/MIGRATION_GUIDE.md b/MIGRATION_GUIDE.md\nindex ec3ae0da9b..2e59d9d445 100644\n--- a/MIGRATION_GUIDE.md\n+++ b/MIGRATION_GUIDE.md\n@@ -1,3 +1,877 @@\n-# Migration Guide\n+# Axios Migration Guide\n \n-## 0.x.x -> 1.1.0\n+> **Migrating from Axios 0.x to 1.x**\n+> \n+> This guide helps developers upgrade from Axios 0.x to 1.x by documenting breaking changes, providing migration strategies, and offering solutions to common upgrade challenges.\n+\n+## Table of Contents\n+\n+- [Overview](#overview)\n+- [Breaking Changes](#breaking-changes)\n+- [Error Handling Migration](#error-handling-migration)\n+- [API Changes](#api-changes)\n+- [Configuration Changes](#configuration-changes)\n+- [Migration Strategies](#migration-strategies)\n+- [Common Patterns](#common-patterns)\n+- [Troubleshooting](#troubleshooting)\n+- [Resources](#resources)\n+\n+## Overview\n+\n+Axios 1.x introduced several breaking changes to improve consistency, security, and developer experience. While these changes provide better error handling and more predictable behavior, they require code updates when migrating from 0.x versions.\n+\n+### Key Changes Summary\n+\n+| Area | 0.x Behavior | 1.x Behavior | Impact |\n+|------|--------------|--------------|--------|\n+| Error Handling | Selective throwing | Consistent throwing | High |\n+| JSON Parsing | Lenient | Strict | Medium |\n+| Browser Support | IE11+ | Modern browsers | Low-Medium |\n+| TypeScript | Partial | Full support | Low |\n+\n+### Migration Complexity\n+\n+- **Simple applications**: 1-2 hours\n+- **Medium applications**: 1-2 days  \n+- **Large applications with complex error handling**: 3-5 days\n+\n+## Breaking Changes\n+\n+### 1. Error Handling Changes\n+\n+**The most significant change in Axios 1.x is how errors are handled.**\n+\n+#### 0.x Behavior\n+```javascript\n+// Axios 0.x - Some HTTP error codes didn't throw\n+axios.get('/api/data')\n+  .then(response => {\n+    // Response interceptor could handle all errors\n+    console.log('Success:', response.data);\n+  });\n+\n+// Response interceptor handled everything\n+axios.interceptors.response.use(\n+  response => response,\n+  error => {\n+    handleError(error);\n+    // Error was \"handled\" and didn't propagate\n+  }\n+);\n+```\n+\n+#### 1.x Behavior\n+```javascript\n+// Axios 1.x - All HTTP errors throw consistently\n+axios.get('/api/data')\n+  .then(response => {\n+    console.log('Success:', response.data);\n+  })\n+  .catch(error => {\n+    // Must handle errors at call site or they propagate\n+    console.error('Request failed:', error);\n+  });\n+\n+// Response interceptor must re-throw or return rejected promise\n+axios.interceptors.response.use(\n+  response => response,\n+  error => {\n+    handleError(error);\n+    // Must explicitly handle propagation\n+    return Promise.reject(error); // or throw error;\n+  }\n+);\n+```\n+\n+#### Impact\n+- **Response interceptors** can no longer \"swallow\" errors silently\n+- **Every API call** must handle errors explicitly or they become unhandled promise rejections\n+- **Centralized error handling** requires new patterns\n+\n+### 2. JSON Parsing Changes\n+\n+#### 0.x Behavior\n+```javascript\n+// Axios 0.x - Lenient JSON parsing\n+// Would attempt to parse even invalid JSON\n+response.data; // Might contain partial data or fallbacks\n+```\n+\n+#### 1.x Behavior\n+```javascript\n+// Axios 1.x - Strict JSON parsing\n+// Throws clear errors for invalid JSON\n+try {\n+  const data = response.data;\n+} catch (error) {\n+  // Handle JSON parsing errors explicitly\n+}\n+```\n+\n+### 3. Request/Response Transform Changes\n+\n+#### 0.x Behavior\n+```javascript\n+// Implicit transformations with some edge cases\n+transformRequest: [function (data) {\n+  // Less predictable behavior\n+  return data;\n+}]\n+```\n+\n+#### 1.x Behavior\n+```javascript\n+// More consistent transformation pipeline\n+transformRequest: [function (data, headers) {\n+  // Headers parameter always available\n+  // More predictable behavior\n+  return data;\n+}]\n+```\n+\n+### 4. Browser Support Changes\n+\n+- **0.x**: Supported IE11 and older browsers\n+- **1.x**: Requires modern browsers with Promise support\n+- **Polyfills**: May be needed for older browser support\n+\n+## Error Handling Migration\n+\n+The error handling changes are the most complex part of migrating to Axios 1.x. Here are proven strategies:\n+\n+### Strategy 1: Centralized Error Handling with Error Boundary\n+\n+```javascript\n+// Create a centralized error handler\n+class ApiErrorHandler {\n+  constructor() {\n+    this.setupInterceptors();\n+  }\n+\n+  setupInterceptors() {\n+    axios.interceptors.response.use(\n+      response => response,\n+      error => {\n+        // Centralized error processing\n+        this.processError(error);\n+        \n+        // Return a resolved promise with error info for handled errors\n+        if (this.isHandledError(error)) {\n+          return Promise.resolve({\n+            data: null,\n+            error: this.normalizeError(error),\n+            handled: true\n+          });\n+        }\n+        \n+        // Re-throw unhandled errors\n+        return Promise.reject(error);\n+      }\n+    );\n+  }\n+\n+  processError(error) {\n+    // Log errors\n+    console.error('API Error:', error);\n+    \n+    // Show user notifications\n+    if (error.response?.status === 401) {\n+      this.handleAuthError();\n+    } else if (error.response?.status >= 500) {\n+      this.showErrorNotification('Server error occurred');\n+    }\n+  }\n+\n+  isHandledError(error) {\n+    // Define which errors are \"handled\" centrally\n+    const handledStatuses = [401, 403, 404, 422, 500, 502, 503];\n+    return handledStatuses.includes(error.response?.status);\n+  }\n+\n+  normalizeError(error) {\n+    return {\n+      status: error.response?.status,\n+      message: error.response?.data?.message || error.message,\n+      code: error.response?.data?.code || error.code\n+    };\n+  }\n+\n+  handleAuthError() {\n+    // Redirect to login, clear tokens, etc.\n+    localStorage.removeItem('token');\n+    window.location.href = '/login';\n+  }\n+\n+  showErrorNotification(message) {\n+    // Show user-friendly error message\n+    console.error(message); // Replace with your notification system\n+  }\n+}\n+\n+// Initialize globally\n+const errorHandler = new ApiErrorHandler();\n+\n+// Usage in components/services\n+async function fetchUserData(userId) {\n+  try {\n+    const response = await axios.get(`/api/users/${userId}`);\n+    \n+    // Check if error was handled centrally\n+    if (response.handled) {\n+      return { data: null, error: response.error };\n+    }\n+    \n+    return { data: response.data, error: null };\n+  } catch (error) {\n+    // Unhandled errors still need local handling\n+    return { data: null, error: { message: 'Unexpected error occurred' } };\n+  }\n+}\n+```\n+\n+### Strategy 2: Wrapper Function Pattern\n+\n+```javascript\n+// Create a wrapper that provides 0.x-like behavior\n+function createApiWrapper() {\n+  const api = axios.create();\n+  \n+  // Add response interceptor for centralized handling\n+  api.interceptors.response.use(\n+    response => response,\n+    error => {\n+      // Handle common errors centrally\n+      if (error.response?.status === 401) {\n+        // Handle auth errors\n+        handleAuthError();\n+      }\n+      \n+      if (error.response?.status >= 500) {\n+        // Handle server errors\n+        showServerErrorNotification();\n+      }\n+      \n+      // Always reject to maintain error propagation\n+      return Promise.reject(error);\n+    }\n+  );\n+\n+  // Wrapper function that mimics 0.x behavior\n+  function safeRequest(requestConfig, options = {}) {\n+    return api(requestConfig)\n+      .then(response => response)\n+      .catch(error => {\n+        if (options.suppressErrors) {\n+          // Return error info instead of throwing\n+          return {\n+            data: null,\n+            error: {\n+              status: error.response?.status,\n+              message: error.response?.data?.message || error.message\n+            }\n+          };\n+        }\n+        throw error;\n+      });\n+  }\n+\n+  return { safeRequest, axios: api };\n+}\n+\n+// Usage\n+const { safeRequest } = createApiWrapper();\n+\n+// For calls where you want centralized error handling\n+const result = await safeRequest(\n+  { method: 'get', url: '/api/data' },\n+  { suppressErrors: true }\n+);\n+\n+if (result.error) {\n+  // Handle error case\n+  console.log('Request failed:', result.error.message);\n+} else {\n+  // Handle success case\n+  console.log('Data:', result.data);\n+}\n+```\n+\n+### Strategy 3: Global Error Handler with Custom Events\n+\n+```javascript\n+// Set up global error handling with events\n+class GlobalErrorHandler extends EventTarget {\n+  constructor() {\n+    super();\n+    this.setupInterceptors();\n+  }\n+\n+  setupInterceptors() {\n+    axios.interceptors.response.use(\n+      response => response,\n+      error => {\n+        // Emit custom event for global handling\n+        this.dispatchEvent(new CustomEvent('apiError', {\n+          detail: { error, timestamp: new Date() }\n+        }));\n+\n+        // Always reject to maintain proper error flow\n+        return Promise.reject(error);\n+      }\n+    );\n+  }\n+}\n+\n+const globalErrorHandler = new GlobalErrorHandler();\n+\n+// Set up global listeners\n+globalErrorHandler.addEventListener('apiError', (event) => {\n+  const { error } = event.detail;\n+  \n+  // Centralized error logic\n+  if (error.response?.status === 401) {\n+    handleAuthError();\n+  }\n+  \n+  if (error.response?.status >= 500) {\n+    showErrorNotification('Server error occurred');\n+  }\n+});\n+\n+// Usage remains clean\n+async function apiCall() {\n+  try {\n+    const response = await axios.get('/api/data');\n+    return response.data;\n+  } catch (error) {\n+    // Error was already handled globally\n+    // Just handle component-specific logic\n+    return null;\n+  }\n+}\n+```\n+\n+## API Changes\n+\n+### Request Configuration\n+\n+#### 0.x to 1.x Changes\n+```javascript\n+// 0.x - Some properties had different defaults\n+const config = {\n+  timeout: 0, // No timeout by default\n+  maxContentLength: -1, // No limit\n+};\n+\n+// 1.x - More secure defaults\n+const config = {\n+  timeout: 0, // Still no timeout, but easier to configure\n+  maxContentLength: 2000, // Default limit for security\n+  maxBodyLength: 2000, // New property\n+};\n+```\n+\n+### Response Object\n+\n+The response object structure remains largely the same, but error responses are more consistent:\n+\n+```javascript\n+// Both 0.x and 1.x\n+response = {\n+  data: {}, // Response body\n+  status: 200, // HTTP status\n+  statusText: 'OK', // HTTP status message  \n+  headers: {}, // Response headers\n+  config: {}, // Request config\n+  request: {} // Request object\n+};\n+\n+// Error responses are more consistent in 1.x\n+error.response = {\n+  data: {}, // Error response body\n+  status: 404, // HTTP error status\n+  statusText: 'Not Found',\n+  headers: {},\n+  config: {},\n+  request: {}\n+};\n+```\n+\n+## Configuration Changes\n+\n+### Default Configuration Updates\n+\n+```javascript\n+// 0.x defaults\n+axios.defaults.timeout = 0; // No timeout\n+axios.defaults.maxContentLength = -1; // No limit\n+\n+// 1.x defaults (more secure)\n+axios.defaults.timeout = 0; // Still no timeout\n+axios.defaults.maxContentLength = 2000; // 2MB limit\n+axios.defaults.maxBodyLength = 2000; // 2MB limit\n+```\n+\n+### Instance Configuration\n+\n+```javascript\n+// 0.x - Instance creation\n+const api = axios.create({\n+  baseURL: 'https://api.example.com',\n+  timeout: 1000,\n+});\n+\n+// 1.x - Same API, but more options available\n+const api = axios.create({\n+  baseURL: 'https://api.example.com',\n+  timeout: 1000,\n+  maxBodyLength: Infinity, // Override default if needed\n+  maxContentLength: Infinity,\n+});\n+```\n+\n+## Migration Strategies\n+\n+### Step-by-Step Migration Process\n+\n+#### Phase 1: Preparation\n+1. **Audit Current Error Handling**\n+   ```bash\n+   # Find all axios usage\n+   grep -r \"axios\\.\" src/\n+   grep -r \"\\.catch\" src/\n+   grep -r \"interceptors\" src/\n+   ```\n+\n+2. **Identify Patterns**\n+   - Response interceptors that handle errors\n+   - Components that rely on centralized error handling\n+   - Authentication and retry logic\n+\n+3. **Create Test Cases**\n+   ```javascript\n+   // Test current error handling behavior\n+   describe('Error Handling Migration', () => {\n+     it('should handle 401 errors consistently', async () => {\n+       // Test authentication error flows\n+     });\n+     \n+     it('should handle 500 errors with user feedback', async () => {\n+       // Test server error handling\n+     });\n+   });\n+   ```\n+\n+#### Phase 2: Implementation\n+1. **Update Dependencies**\n+   ```bash\n+   npm update axios\n+   ```\n+\n+2. **Implement New Error Handling**\n+   - Choose one of the strategies above\n+   - Update response interceptors\n+   - Add error handling to API calls\n+\n+3. **Update Authentication Logic**\n+   ```javascript\n+   // 0.x pattern\n+   axios.interceptors.response.use(null, error => {\n+     if (error.response?.status === 401) {\n+       logout();\n+       // Error was \"handled\"\n+     }\n+   });\n+\n+   // 1.x pattern\n+   axios.interceptors.response.use(\n+     response => response,\n+     error => {\n+       if (error.response?.status === 401) {\n+         logout();\n+       }\n+       return Promise.reject(error); // Always propagate\n+     }\n+   );\n+   ```\n+\n+#### Phase 3: Testing and Validation\n+1. **Test Error Scenarios**\n+   - Network failures\n+   - HTTP error codes (401, 403, 404, 500, etc.)\n+   - Timeout errors\n+   - JSON parsing errors\n+\n+2. **Validate User Experience**\n+   - Error messages are shown appropriately\n+   - Authentication redirects work\n+   - Loading states are handled correctly\n+\n+### Gradual Migration Approach\n+\n+For large applications, consider gradual migration:\n+\n+```javascript\n+// Create a compatibility layer\n+const axiosCompat = {\n+  // Use new axios instance for new code\n+  v1: axios.create({\n+    // 1.x configuration\n+  }),\n+  \n+  // Wrapper for legacy code\n+  legacy: createLegacyWrapper(axios.create({\n+    // Configuration that mimics 0.x behavior\n+  }))\n+};\n+\n+function createLegacyWrapper(axiosInstance) {\n+  // Add interceptors that provide 0.x-like behavior\n+  axiosInstance.interceptors.response.use(\n+    response => response,\n+    error => {\n+      // Handle errors in 0.x style for legacy code\n+      handleLegacyError(error);\n+      // Don't propagate certain errors\n+      if (shouldSuppressError(error)) {\n+        return Promise.resolve({ data: null, error: true });\n+      }\n+      return Promise.reject(error);\n+    }\n+  );\n+  \n+  return axiosInstance;\n+}\n+```\n+\n+## Common Patterns\n+\n+### Authentication Interceptors\n+\n+#### Updated Authentication Pattern\n+```javascript\n+// Token refresh interceptor for 1.x\n+let isRefreshing = false;\n+let refreshSubscribers = [];\n+\n+function subscribeTokenRefresh(cb) {\n+  refreshSubscribers.push(cb);\n+}\n+\n+function onTokenRefreshed(token) {\n+  refreshSubscribers.forEach(cb => cb(token));\n+  refreshSubscribers = [];\n+}\n+\n+axios.interceptors.response.use(\n+  response => response,\n+  async error => {\n+    const originalRequest = error.config;\n+    \n+    if (error.response?.status === 401 && !originalRequest._retry) {\n+      if (isRefreshing) {\n+        // Wait for token refresh\n+        return new Promise(resolve => {\n+          subscribeTokenRefresh(token => {\n+            originalRequest.headers.Authorization = `Bearer ${token}`;\n+            resolve(axios(originalRequest));\n+          });\n+        });\n+      }\n+      \n+      originalRequest._retry = true;\n+      isRefreshing = true;\n+      \n+      try {\n+        const newToken = await refreshToken();\n+        onTokenRefreshed(newToken);\n+        isRefreshing = false;\n+        \n+        originalRequest.headers.Authorization = `Bearer ${newToken}`;\n+        return axios(originalRequest);\n+      } catch (refreshError) {\n+        isRefreshing = false;\n+        logout();\n+        return Promise.reject(refreshError);\n+      }\n+    }\n+    \n+    return Promise.reject(error);\n+  }\n+);\n+```\n+\n+### Retry Logic\n+\n+```javascript\n+// Retry interceptor for 1.x\n+function createRetryInterceptor(maxRetries = 3, retryDelay = 1000) {\n+  return axios.interceptors.response.use(\n+    response => response,\n+    async error => {\n+      const config = error.config;\n+      \n+      if (!config || !config.retry) {\n+        return Promise.reject(error);\n+      }\n+      \n+      config.__retryCount = config.__retryCount || 0;\n+      \n+      if (config.__retryCount >= maxRetries) {\n+        return Promise.reject(error);\n+      }\n+      \n+      config.__retryCount += 1;\n+      \n+      // Exponential backoff\n+      const delay = retryDelay * Math.pow(2, config.__retryCount - 1);\n+      await new Promise(resolve => setTimeout(resolve, delay));\n+      \n+      return axios(config);\n+    }\n+  );\n+}\n+\n+// Usage\n+const api = axios.create();\n+createRetryInterceptor(3, 1000);\n+\n+// Make request with retry\n+api.get('/api/data', { retry: true });\n+```\n+\n+### Loading State Management\n+\n+```javascript\n+// Loading interceptor for 1.x\n+class LoadingManager {\n+  constructor() {\n+    this.requests = new Set();\n+    this.setupInterceptors();\n+  }\n+  \n+  setupInterceptors() {\n+    axios.interceptors.request.use(config => {\n+      this.requests.add(config);\n+      this.updateLoadingState();\n+      return config;\n+    });\n+    \n+    axios.interceptors.response.use(\n+      response => {\n+        this.requests.delete(response.config);\n+        this.updateLoadingState();\n+        return response;\n+      },\n+      error => {\n+        this.requests.delete(error.config);\n+        this.updateLoadingState();\n+        return Promise.reject(error);\n+      }\n+    );\n+  }\n+  \n+  updateLoadingState() {\n+    const isLoading = this.requests.size > 0;\n+    // Update your loading UI\n+    document.body.classList.toggle('loading', isLoading);\n+  }\n+}\n+\n+const loadingManager = new LoadingManager();\n+```\n+\n+## Troubleshooting\n+\n+### Common Migration Issues\n+\n+#### Issue 1: Unhandled Promise Rejections\n+\n+**Problem:**\n+```javascript\n+// This pattern worked in 0.x but causes unhandled rejections in 1.x\n+axios.get('/api/data'); // No .catch() handler\n+```\n+\n+**Solution:**\n+```javascript\n+// Always handle promises\n+axios.get('/api/data')\n+  .catch(error => {\n+    // Handle error appropriately\n+    console.error('Request failed:', error.message);\n+  });\n+\n+// Or use async/await with try/catch\n+async function fetchData() {\n+  try {\n+    const response = await axios.get('/api/data');\n+    return response.data;\n+  } catch (error) {\n+    console.error('Request failed:', error.message);\n+    return null;\n+  }\n+}\n+```\n+\n+#### Issue 2: Response Interceptors Not \"Handling\" Errors\n+\n+**Problem:**\n+```javascript\n+// 0.x style - interceptor \"handled\" errors\n+axios.interceptors.response.use(null, error => {\n+  showErrorMessage(error.message);\n+  // Error was considered \"handled\"\n+});\n+```\n+\n+**Solution:**\n+```javascript\n+// 1.x style - explicitly control error propagation\n+axios.interceptors.response.use(\n+  response => response,\n+  error => {\n+    showErrorMessage(error.message);\n+    \n+    // Choose whether to propagate the error\n+    if (shouldPropagateError(error)) {\n+      return Promise.reject(error);\n+    }\n+    \n+    // Return success-like response for \"handled\" errors\n+    return Promise.resolve({\n+      data: null,\n+      handled: true,\n+      error: normalizeError(error)\n+    });\n+  }\n+);\n+```\n+\n+#### Issue 3: JSON Parsing Errors\n+\n+**Problem:**\n+```javascript\n+// 1.x is stricter about JSON parsing\n+// This might throw where 0.x was lenient\n+const data = response.data;\n+```\n+\n+**Solution:**\n+```javascript\n+// Add response transformer for better error handling\n+axios.defaults.transformResponse = [\n+  function (data) {\n+    if (typeof data === 'string') {\n+      try {\n+        return JSON.parse(data);\n+      } catch (e) {\n+        // Handle JSON parsing errors gracefully\n+        console.warn('Invalid JSON response:', data);\n+        return { error: 'Invalid JSON', rawData: data };\n+      }\n+    }\n+    return data;\n+  }\n+];\n+```\n+\n+#### Issue 4: TypeScript Errors After Upgrade\n+\n+**Problem:**\n+```typescript\n+// TypeScript errors after upgrade\n+const response = await axios.get('/api/data');\n+// Property 'someProperty' does not exist on type 'any'\n+```\n+\n+**Solution:**\n+```typescript\n+// Define proper interfaces\n+interface ApiResponse {\n+  data: any;\n+  message: string;\n+  success: boolean;\n+}\n+\n+const response = await axios.get<ApiResponse>('/api/data');\n+// Now properly typed\n+console.log(response.data.data);\n+```\n+\n+### Debug Migration Issues\n+\n+#### Enable Debug Logging\n+```javascript\n+// Add request/response logging\n+axios.interceptors.request.use(config => {\n+  console.log('Request:', config);\n+  return config;\n+});\n+\n+axios.interceptors.response.use(\n+  response => {\n+    console.log('Response:', response);\n+    return response;\n+  },\n+  error => {\n+    console.log('Error:', error);\n+    return Promise.reject(error);\n+  }\n+);\n+```\n+\n+#### Compare Behavior\n+```javascript\n+// Create side-by-side comparison during migration\n+const axios0x = require('axios-0x'); // Keep old version for testing\n+const axios1x = require('axios');\n+\n+async function compareRequests(config) {\n+  try {\n+    const [result0x, result1x] = await Promise.allSettled([\n+      axios0x(config),\n+      axios1x(config)\n+    ]);\n+    \n+    console.log('0.x result:', result0x);\n+    console.log('1.x result:', result1x);\n+  } catch (error) {\n+    console.log('Comparison error:', error);\n+  }\n+}\n+```\n+\n+## Resources\n+\n+### Official Documentation\n+- [Axios 1.x Documentation](https://axios-http.com/)\n+- [Axios GitHub Repository](https://github.com/axios/axios)\n+- [Axios Changelog](https://github.com/axios/axios/blob/main/CHANGELOG.md)\n+\n+### Migration Tools\n+- [Axios Migration Codemod](https://github.com/axios/axios-migration-codemod) *(if available)*\n+- [ESLint Rules for Axios 1.x](https://github.com/axios/eslint-plugin-axios) *(if available)*\n+\n+### Community Resources\n+- [Stack Overflow - Axios Migration Questions](https://stackoverflow.com/questions/tagged/axios+migration)\n+- [GitHub Discussions](https://github.com/axios/axios/discussions)\n+- [Axios Discord Community](https://discord.gg/axios) *(if available)*\n+\n+### Related Issues\n+- [Error Handling Changes Discussion](https://github.com/axios/axios/issues/7208)\n+- [Migration Guide Request](https://github.com/axios/axios/issues/xxxx) *(link to related issues)*\n+\n+---\n+\n+## Need Help?\n+\n+If you encounter issues during migration that aren't covered in this guide:\n+\n+1. **Search existing issues** in the [Axios GitHub repository](https://github.com/axios/axios/issues)\n+2. **Ask questions** in [GitHub Discussions](https://github.com/axios/axios/discussions)\n+3. **Contribute improvements** to this migration guide\n+\n+---\n+\n+*This migration guide is maintained by the community. If you find errors or have suggestions, please [open an issue](https://github.com/axios/axios/issues) or submit a pull request.*\n\\ No newline at end of file\n", "test_patch": "", "problem_statement": "Lack of documentation on breaking changes from 0.x to 1.x \u2014 what changed with error handling?\n### Section/Content To Improve\n\nMore specifically, I see error handling changed and there's no clear path forward.\n\nAs mentioned in a [post from 2023](https://github.com/axios/axios/discussions/5818), Axios now throws up for many error codes where it didn't before.\n\nIn my specific case, errors were handled centralized in a response interceptor, and now it looks like I'll have to add empty and meaningless `.catch()` calls in _every. API. call._ Is there any other way to signal an error as handled, so it doesn't get thrown? Should I open an issue to request that, or it doesn't make any sense?\n\nBesides that, there's a `MIGRATION_GUIDE.md` in the repo......... empty \ud83d\ude2c\nLastly, the changelog doesn't help to explain what changed on the big picture, just each code change that happened. Nothing there pointed me to this change in error handling, so I got a bit puzzled... until I tried to work around it and realized it wasn't really achievable without deeper changes.\n\n### Suggested Improvement\n\n1. Even though there are years since 1.x got launched, there should still be docs at least with breaking changes between releases\n2. `MIGRATION_GUIDE.md` should be filled, as it's even mentioned at https://axios-http.com/docs/notes\n3. Add the Migration Guide to the sidebar; it should be a first-class citizen in the docs, not relegated to an odd place like a link under \"Other > Notes > Resources\"\n\nBonus question: is there anything that can be done to still centralize error handling in interceptors?\n\n### Relevant File(s)\n\n```bash\nMIGRATION_GUIDE.md\n```\n", "hints_text": "Hello @igorsantos07,\nI\u2019m interested in working on this issue. Could you please assign it to me?\nSorry @ashvin2005, I'm not a member of the repo, just a humble ~complainer~ issue reporter \ud83d\ude05 \n\nNonetheless, I guess anyone interested will open the story and see your interest on it, so I think your comment is enough by now haha\n\nCheers!\nHi @davecardwell,\nI\u2019ve raised PR #7218\n to address issue #7208.\nPlease review it when you get a chance and merge if it looks good. Thanks!", "created_at": "2025-11-10T07:59:54Z"}
{"repo": "axios/axios", "pull_number": 7215, "instance_id": "axios__axios.ef36347f.7215", "issue_numbers": [], "base_commit": "ef36347f", "patch": "diff --git a/CONTRIBUTING.md b/CONTRIBUTING.md\nindex 23cfc79aaf..a19cee2cb0 100644\n--- a/CONTRIBUTING.md\n+++ b/CONTRIBUTING.md\n@@ -20,9 +20,9 @@ Please update the [documentation](https://axios-http.com/docs/intro) accordingly\n \n ## Developing\n \n-- `npm run test` run the jasmine and mocha tests\n-- `npm run build` run rollup and bundle the source\n-- `npm run version` prepare the code for release\n+- `npm run test` runs the jasmine and mocha tests\n+- `npm run build` runs rollup and bundles the source\n+- `npm run version` prepares the code for release\n \n ## Running Examples\n \ndiff --git a/ECOSYSTEM.md b/ECOSYSTEM.md\nindex e6886c8f9b..b0257fe330 100644\n--- a/ECOSYSTEM.md\n+++ b/ECOSYSTEM.md\n@@ -9,7 +9,7 @@ This is a list of axios related libraries and resources. If you have a suggestio\n * [axios-vcr](https://github.com/nettofarah/axios-vcr) - \ud83d\udcfc Record and Replay Axios requests\n * [@3846masa/axios-cookiejar-support](https://github.com/3846masa/axios-cookiejar-support) - Add tough-cookie support to axios\n * [axios-method-override](https://github.com/jacobbuck/axios-method-override) - Axios http request method override plugin\n-* [axios-cache-plugin](https://github.com/jin5354/axios-cache-plugin) - Help you cache GET request when using axios.\n+* [axios-cache-plugin](https://github.com/jin5354/axios-cache-plugin) - Help you cache GET requests when using axios.\n * [axios-extensions](https://github.com/kuitos/axios-extensions) - A collection of axios extensions, including throttle and cache GET request plugin.\n * [axios-fetch](https://github.com/lifeomic/axios-fetch) - A WebAPI Fetch implementation backed by an Axios client\n * [axios-actions](https://github.com/davestewart/axios-actions) - Bundle endpoints as callable, reusable services\n@@ -17,7 +17,7 @@ This is a list of axios related libraries and resources. If you have a suggestio\n * [axios-data-unpacker](https://github.com/anubhavsrivastava/axios-data-unpacker) - Axios interceptor that unpacks HTTP responses so that you can focus on actual server data.\n * [r2curl](https://github.com/uyu423/r2curl) - Extracts the cURL command string from the Axios object. (AxiosResponse, AxiosRequestConfig)\n * [swagger-taxos-codegen](https://github.com/michalzaq12/swagger-taxos-codegen) - Axios based Swagger Codegen (tailored for typescript)\n-* [axios-endpoints](https://github.com/renancaraujo/axios-endpoints) - Axios endpoints helps you to create a more concise endpoint mapping with axios.\n+* [axios-endpoints](https://github.com/renancaraujo/axios-endpoints) - Axios endpoints help you to create a more concise endpoint mapping with axios.\n * [axios-multi-api](https://github.com/MattCCC/axios-multi-api) - Easy API handling whenever there are many endpoints to add. It helps to make Axios requests in an easy and declarative manner.\n * [axios-url-template](https://github.com/rafw87/axios-url-template) - Axios interceptor adding support for URL templates.\n * [zodios](https://www.zodios.org) - Typesafe API client based on axios\n@@ -39,7 +39,7 @@ This is a list of axios related libraries and resources. If you have a suggestio\n ### Unit testing\n \n * [axiosist](https://github.com/Gerhut/axiosist) - Axios based supertest: convert node.js request handler to axios adapter, used for node.js server unit test.\n-* [axios-mock-adapter](https://github.com/ctimmerm/axios-mock-adapter) \u2014 Axios adapter that allows to easily mock requests\n+* [axios-mock-adapter](https://github.com/ctimmerm/axios-mock-adapter) \u2014 Axios adapter that allows for easily mocking requests\n * [axios-test-instance](https://github.com/remcohaszing/axios-test-instance) \u2014 Test NodeJS backends using Axios\n * [moxios](https://github.com/axios/moxios) - Mock axios requests for testing\n * [mocha-axios](https://github.com/jdrydn/mocha-axios) - Streamlined integration testing with Mocha & Axios\ndiff --git a/README.md b/README.md\nindex 5e08671482..090cf6e076 100644\n--- a/README.md\n+++ b/README.md\n@@ -161,7 +161,7 @@ import axios from 'axios';\n console.log(axios.isCancel('something'));\n ````\n \n-If you use `require` for importing, **only default export is available**:\n+If you use `require` for importing, **only the default export is available**:\n \n ```js\n const axios = require('axios');\n@@ -367,9 +367,9 @@ These are the available config options for making requests. Only the `url` is re\n   // `method` is the request method to be used when making the request\n   method: 'get', // default\n \n-  // `baseURL` will be prepended to `url` unless `url` is absolute and option `allowAbsoluteUrls` is set to true.\n+  // `baseURL` will be prepended to `url` unless `url` is absolute and the option `allowAbsoluteUrls` is set to true.\n   // It can be convenient to set `baseURL` for an instance of axios to pass relative URLs\n-  // to methods of that instance.\n+  // to the methods of that instance.\n   baseURL: 'https://some-domain.com/api/',\n \n   // `allowAbsoluteUrls` determines whether or not absolute URLs will override a configured `baseUrl`.\n@@ -411,7 +411,7 @@ These are the available config options for making requests. Only the `url` is re\n     // Custom encoder function which sends key/value pairs in an iterative fashion.\n     encode?: (param: string): string => { /* Do custom operations here and return transformed string */ },\n \n-    // Custom serializer function for the entire parameter. Allows user to mimic pre 1.x behaviour.\n+    // Custom serializer function for the entire parameter. Allows the user to mimic pre 1.x behaviour.\n     serialize?: (params: Record<string, any>, options?: ParamsSerializerOptions ),\n \n     // Configuration for formatting array indexes in the params.\n@@ -419,8 +419,8 @@ These are the available config options for making requests. Only the `url` is re\n   },\n \n   // `data` is the data to be sent as the request body\n-  // Only applicable for request methods 'PUT', 'POST', 'DELETE , and 'PATCH'\n-  // When no `transformRequest` is set, must be of one of the following types:\n+  // Only applicable for request methods 'PUT', 'POST', 'DELETE', and 'PATCH'\n+  // When no `transformRequest` is set, it must be of one of the following types:\n   // - string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams\n   // - Browser only: FormData, File, Blob\n   // - Node only: Stream, Buffer, FormData (form-data package)\n@@ -472,7 +472,7 @@ These are the available config options for making requests. Only the `url` is re\n   // 'utf8', 'UTF8', 'utf16le', 'UTF16LE'\n   responseEncoding: 'utf8', // default\n \n-  // `xsrfCookieName` is the name of the cookie to use as a value for xsrf token\n+  // `xsrfCookieName` is the name of the cookie to use as a value for the xsrf token\n   xsrfCookieName: 'XSRF-TOKEN', // default\n \n   // `xsrfHeaderName` is the name of the http header that carries the xsrf token value\n@@ -551,7 +551,7 @@ These are the available config options for making requests. Only the `url` is re\n   // Use `false` to disable proxies, ignoring environment variables.\n   // `auth` indicates that HTTP Basic auth should be used to connect to the proxy, and\n   // supplies credentials.\n-  // This will set an `Proxy-Authorization` header, overwriting any existing\n+  // This will set a `Proxy-Authorization` header, overwriting any existing\n   // `Proxy-Authorization` custom headers you have set using `headers`.\n   // If the proxy server uses HTTPS, then you must set the protocol to `https`.\n   proxy: {\n@@ -623,7 +623,7 @@ These are the available config options for making requests. Only the `url` is re\n \n ## Response Schema\n \n-The response for a request contains the following information.\n+The response to a request contains the following information.\n \n ```js\n {\n@@ -722,20 +722,20 @@ const instance = axios.create();\n \n // Add a request interceptor\n instance.interceptors.request.use(function (config) {\n-    // Do something before request is sent\n+    // Do something before the request is sent\n     return config;\n   }, function (error) {\n-    // Do something with request error\n+    // Do something with the request error\n     return Promise.reject(error);\n   });\n \n // Add a response interceptor\n instance.interceptors.response.use(function (response) {\n-    // Any status code that lie within the range of 2xx cause this function to trigger\n+    // Any status code that lies within the range of 2xx causes this function to trigger\n     // Do something with response data\n     return response;\n   }, function (error) {\n-    // Any status codes that falls outside the range of 2xx cause this function to trigger\n+    // Any status codes that fall outside the range of 2xx cause this function to trigger\n     // Do something with response error\n     return Promise.reject(error);\n   });\n@@ -767,7 +767,7 @@ instance.interceptors.request.use(function () {/*...*/});\n \n When you add request interceptors, they are presumed to be asynchronous by default. This can cause a delay\n in the execution of your axios request when the main thread is blocked (a promise is created under the hood for\n-the interceptor and your request gets put on the bottom of the call stack). If your request interceptors are synchronous you can add a flag\n+the interceptor and your request gets put at the bottom of the call stack). If your request interceptors are synchronous you can add a flag\n to the options object that will tell axios to run the code synchronously and avoid any delays in request execution.\n \n ```js\n@@ -793,7 +793,7 @@ axios.interceptors.request.use(function (config) {\n }, null, { runWhen: onGetCall });\n ```\n \n-> **Note:** options parameter(having `synchronous` and `runWhen` properties) is only supported for request interceptors at the moment.\n+> **Note:** The options parameter(having `synchronous` and `runWhen` properties) is only supported for request interceptors at the moment.\n \n ### Interceptor Execution Order\n \n@@ -832,7 +832,7 @@ instance.interceptors.response.use(interceptor('Response Interceptor 3'));\n \n ### Multiple Interceptors\n \n-Given you add multiple response interceptors\n+Given that you add multiple response interceptors\n and when the response was fulfilled\n - then each interceptor is executed\n - then they are executed in the order they were added\n@@ -843,11 +843,11 @@ and when the response was fulfilled\n     - then the following rejection-interceptor is called\n     - once caught, another following fulfill-interceptor is called again (just like in a promise chain).\n \n-Read [the interceptor tests](./test/specs/interceptors.spec.js) for seeing all this in code.\n+Read [the interceptor tests](./test/specs/interceptors.spec.js) to see all this in code.\n \n ## Error Types\n \n-There are many different axios error messages that can appear that can provide basic information about the specifics of the error and where opportunities may lie in debugging.\n+There are many different axios error messages that can appear which can provide basic information about the specifics of the error and where opportunities may lie in debugging.\n \n The general structure of axios errors is as follows:\n | Property  | Definition  |\n@@ -856,7 +856,7 @@ The general structure of axios errors is as follows:\n | name     | This defines where the error originated from. For axios, it will always be an 'AxiosError'. |\n | stack    | Provides the stack trace of the error. |\n | config   | An axios config object with specific instance configurations defined by the user from when the request was made |\n-| code     | Represents an axios identified error. The table below lists out specific definitions for internal axios error.  |\n+| code     | Represents an axios identified error. The table below lists specific definitions for internal axios error.  |\n | status   | HTTP response status code. See [here](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes) for common HTTP response status code meanings.\n \n Below is a list of potential axios identified error:\n@@ -870,7 +870,7 @@ Below is a list of potential axios identified error:\n | ERR_INVALID_URL           | Invalid URL provided for axios request.                                                                                                                                                                                                                                                                                                                                                        |\n | ECONNABORTED              | Typically indicates that the request has been timed out (unless `transitional.clarifyTimeoutError` is set) or aborted by the browser or its plugin.                                                                                                                                                                                                                                            |\n | ERR_CANCELED              | Feature or method is canceled explicitly by the user using an AbortSignal (or a CancelToken).                                                                                                                                                                                                                                                                                                  |\n-| ETIMEDOUT                 | Request timed out due to exceeding default axios timelimit. `transitional.clarifyTimeoutError` must be set to `true`, otherwise a generic `ECONNABORTED` error will be thrown instead.                                                                                                                                                                                                         |\n+| ETIMEDOUT                 | Request timed out due to exceeding the default axios timelimit. `transitional.clarifyTimeoutError` must be set to `true`, otherwise a generic `ECONNABORTED` error will be thrown instead.                                                                                                                                                                                                         |\n | ERR_NETWORK               | Network-related issue. In the browser, this error can also be caused by a [CORS](https://developer.mozilla.org/ru/docs/Web/HTTP/Guides/CORS) or [Mixed Content](https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content) policy violation. The browser does not allow the JS code to clarify the real reason for the error caused by security issues, so please check the console. |\n | ERR_FR_TOO_MANY_REDIRECTS | Request is redirected too many times; exceeds max redirects specified in axios configuration.                                                                                                                                                                                                                                                                                                  |\n | ERR_BAD_RESPONSE          | Response cannot be parsed properly or is in an unexpected format. Usually related to a response with `5xx` status code.                                                                                                                                                                                                                                                                          |\n@@ -878,7 +878,7 @@ Below is a list of potential axios identified error:\n \n ## Handling Errors\n \n-the default behavior is to reject every response that returns with a status code that falls out of the range of 2xx and treat it as an error.\n+The default behavior is to reject every response that returns with a status code that falls out of the range of 2xx and treat it as an error.\n \n ```js\n axios.get('/user/12345')\n@@ -925,7 +925,7 @@ axios.get('/user/12345')\n \n ### AbortController\n \n-Starting from `v0.22.0` Axios supports AbortController to cancel requests in fetch API way:\n+Starting from `v0.22.0` Axios supports AbortController to cancel requests in a fetch API way:\n \n ```js\n const controller = new AbortController();\n@@ -1239,7 +1239,7 @@ All files will be sent with the same field names: `files[]`.\n \n ## \ud83c\udd95 HTML Form Posting (browser)\n \n-Pass HTML Form element as a payload to submit it as `multipart/form-data` content.\n+Pass an HTML Form element as a payload to submit it as `multipart/form-data` content.\n \n ```js\n await axios.postForm('https://httpbin.org/post', document.querySelector('#htmlForm'));\n@@ -1351,7 +1351,7 @@ const {data} = await axios.post(SERVER_URL, readableStream, {\n \n > **\u26a0\ufe0f Warning**\n > It is recommended to disable redirects by setting maxRedirects: 0 to upload the stream in the **node.js** environment,\n-> as follow-redirects package will buffer the entire stream in RAM without following the \"backpressure\" algorithm.\n+> as the follow-redirects package will buffer the entire stream in RAM without following the \"backpressure\" algorithm.\n \n \n ## \ud83c\udd95 Rate limiting\n@@ -1372,8 +1372,8 @@ const {data} = await axios.post(LOCAL_SERVER_URL, myBuffer, {\n \n Axios has its own `AxiosHeaders` class to manipulate headers using a Map-like API that guarantees caseless work.\n Although HTTP is case-insensitive in headers, Axios will retain the case of the original header for stylistic reasons\n-and for a workaround when servers mistakenly consider the header's case.\n-The old approach of directly manipulating headers object is still available, but deprecated and not recommended for future usage.\n+and as a workaround when servers mistakenly consider the header's case.\n+The old approach of directly manipulating the headers object is still available, but deprecated and not recommended for future usage.\n \n ### Working with headers\n \n@@ -1465,7 +1465,7 @@ set(headers?: RawAxiosHeaders | AxiosHeaders | string, rewrite?: boolean);\n ```\n \n The `rewrite` argument controls the overwriting behavior:\n-- `false` - do not overwrite if header's value is set (is not `undefined`)\n+- `false` - do not overwrite if the header's value is set (is not `undefined`)\n - `undefined` (default) - overwrite the header unless its value is set to `false`\n - `true` - rewrite anyway\n \n@@ -1554,7 +1554,7 @@ Returns `true` if at least one header has been cleared.\n If the headers object was changed directly, it can have duplicates with the same name but in different cases.\n This method normalizes the headers object by combining duplicate keys into one.\n Axios uses this method internally after calling each interceptor.\n-Set `format` to true for converting headers name to lowercase and capitalize the initial letters (`cOntEnt-type` => `Content-Type`)\n+Set `format` to true for converting header names to lowercase and capitalizing the initial letters (`cOntEnt-type` => `Content-Type`)\n \n ```js\n const headers = new AxiosHeaders({\n@@ -1587,7 +1587,7 @@ Returns a new `AxiosHeaders` instance.\n toJSON(asStrings?: boolean): RawAxiosHeaders;\n ````\n \n-Resolve all internal headers values into a new null prototype object.\n+Resolve all internal header values into a new null prototype object.\n Set `asStrings` to true to resolve arrays as a string containing all elements, separated by commas.\n \n ### AxiosHeaders.from(thing?)\n@@ -1643,7 +1643,7 @@ const fetchAxios = axios.create({\n const {data} = fetchAxios.get(url);\n ```\n \n-The adapter supports the same functionality as `xhr` adapter, **including upload and download progress capturing**.\n+The adapter supports the same functionality as the `xhr` adapter, **including upload and download progress capturing**.\n Also, it supports additional response types such as `stream` and `formdata` (if supported by the environment).\n \n ### \ud83d\udd25 Custom fetch\n", "test_patch": "", "problem_statement": "", "hints_text": "", "created_at": "2025-11-07T11:55:18Z"}
{"repo": "axios/axios", "pull_number": 7207, "instance_id": "axios__axios.ef36347f.7207", "issue_numbers": [], "base_commit": "ef36347f", "patch": "diff --git a/CHANGELOG.md b/CHANGELOG.md\nindex 56a6ae1c70..1e72305cb6 100644\n--- a/CHANGELOG.md\n+++ b/CHANGELOG.md\n@@ -1,5 +1,23 @@\n # Changelog\n \n+## [1.13.2](https://github.com/axios/axios/compare/v1.13.1...v1.13.2) (2025-11-04)\n+\n+\n+### Bug Fixes\n+\n+* **http:** fix 'socket hang up' bug for keep-alive requests when using timeouts; ([#7206](https://github.com/axios/axios/issues/7206)) ([8d37233](https://github.com/axios/axios/commit/8d372335f5c50ecd01e8615f2468a9eb19703117))\n+* **http:** use default export for http2 module to support stubs; ([#7196](https://github.com/axios/axios/issues/7196)) ([0588880](https://github.com/axios/axios/commit/0588880ac7ddba7594ef179930493884b7e90bf5))\n+\n+\n+### Performance Improvements\n+\n+* **http:** fix early loop exit; ([#7202](https://github.com/axios/axios/issues/7202)) ([12c314b](https://github.com/axios/axios/commit/12c314b603e7852a157e93e47edb626a471ba6c5))\n+\n+### Contributors to this release\n+\n+- <img src=\"https://avatars.githubusercontent.com/u/12586868?v&#x3D;4&amp;s&#x3D;18\" alt=\"avatar\" width=\"18\"/> [Dmitriy Mozgovoy](https://github.com/DigitalBrainJS \"+28/-9 (#7206 #7202 )\")\n+- <img src=\"https://avatars.githubusercontent.com/u/1174718?v&#x3D;4&amp;s&#x3D;18\" alt=\"avatar\" width=\"18\"/> [Kasper Isager Dalsgar\u00f0](https://github.com/kasperisager \"+9/-9 (#7196 )\")\n+\n ## [1.13.1](https://github.com/axios/axios/compare/v1.13.0...v1.13.1) (2025-10-28)\n \n \ndiff --git a/bower.json b/bower.json\nindex a8a10f4478..9a1f778b3e 100644\n--- a/bower.json\n+++ b/bower.json\n@@ -1,7 +1,7 @@\n {\n   \"name\": \"axios\",\n   \"main\": \"./dist/axios.js\",\n-  \"version\": \"1.13.1\",\n+  \"version\": \"1.13.2\",\n   \"homepage\": \"https://axios-http.com\",\n   \"authors\": [\n     \"Matt Zabriskie\"\ndiff --git a/lib/env/data.js b/lib/env/data.js\nindex d969ffe6dc..38dd6aac22 100644\n--- a/lib/env/data.js\n+++ b/lib/env/data.js\n@@ -1,1 +1,1 @@\n-export const VERSION = \"1.13.1\";\n\\ No newline at end of file\n+export const VERSION = \"1.13.2\";\n\\ No newline at end of file\ndiff --git a/package-lock.json b/package-lock.json\nindex 6a524e493e..4b3988d544 100644\n--- a/package-lock.json\n+++ b/package-lock.json\n@@ -1,12 +1,12 @@\n {\n   \"name\": \"axios\",\n-  \"version\": \"1.13.1\",\n+  \"version\": \"1.13.2\",\n   \"lockfileVersion\": 2,\n   \"requires\": true,\n   \"packages\": {\n     \"\": {\n       \"name\": \"axios\",\n-      \"version\": \"1.13.1\",\n+      \"version\": \"1.13.2\",\n       \"license\": \"MIT\",\n       \"dependencies\": {\n         \"follow-redirects\": \"^1.15.6\",\ndiff --git a/package.json b/package.json\nindex 35afb93bb9..f85fdb4766 100644\n--- a/package.json\n+++ b/package.json\n@@ -1,6 +1,6 @@\n {\n   \"name\": \"axios\",\n-  \"version\": \"1.13.1\",\n+  \"version\": \"1.13.2\",\n   \"description\": \"Promise based HTTP client for the browser and node.js\",\n   \"main\": \"index.js\",\n   \"exports\": {\n", "test_patch": "", "problem_statement": "", "hints_text": "", "created_at": "2025-11-04T19:23:38Z"}
{"repo": "axios/axios", "pull_number": 7206, "instance_id": "axios__axios.ef36347f.7206", "issue_numbers": ["6113"], "base_commit": "ef36347f", "patch": "diff --git a/lib/adapters/http.js b/lib/adapters/http.js\nindex 524c278505..ccc89be66d 100755\n--- a/lib/adapters/http.js\n+++ b/lib/adapters/http.js\n@@ -858,6 +858,9 @@ export default isHttpAdapterSupported && function httpAdapter(config) {\n           req\n         ));\n       });\n+    } else {\n+      // explicitly reset the socket timeout value for a possible `keep-alive` request\n+      req.setTimeout(0);\n     }\n \n \n", "test_patch": "diff --git a/test/unit/adapters/http.js b/test/unit/adapters/http.js\nindex 6c4375a50b..864d29a3c5 100644\n--- a/test/unit/adapters/http.js\n+++ b/test/unit/adapters/http.js\n@@ -2682,6 +2682,21 @@ describe('supports http with nodejs', function () {\n       assert.strictEqual(await getStream(err.response.data), 'OK');\n     }\n   });\n+\n+  describe('keep-alive', () => {\n+    it('should not fail with \"socket hang up\" when using timeouts', async () => {\n+      server = await startHTTPServer(async (req, res) => {\n+        if (req.url === '/wait') {\n+          await new Promise(resolve => setTimeout(resolve, 5000));\n+        }\n+        res.end('ok');\n+      })\n+\n+      const baseURL = LOCAL_SERVER_URL;\n+      await axios.get('/1', {baseURL, timeout: 1000});\n+      await axios.get(`/wait`, {baseURL, timeout: 0});\n+    }, 15000);\n+  });\n });\n \n \n", "problem_statement": "HTTP Keep-alive, \"socket hang up\"  ECONNERR on a long-running second request\n### Describe the bug\r\n\r\nOn keep-alive connections, if a timeout value is given to the first request but not on subsequent requests, the subsequent requests will eventually throw a \"socket hang up\" error.\r\n\r\n### To Reproduce\r\n\r\n```js\r\nconst http = require('http');\r\nconst axios = require('axios');\r\n\r\ndescribe('socket hang up', () => {\r\n    let server;\r\n    beforeAll(done => {\r\n        server = http.createServer(async (req, res) => {\r\n            if (req.url === '/wait') {\r\n                await new Promise(resolve => setTimeout(resolve, 5000));\r\n            }\r\n            res.end('ok');\r\n        });\r\n        server.listen(3000, done);\r\n    });\r\n\r\n    afterAll(done => {\r\n        server.close(done);\r\n    });\r\n\r\n    it('will fail with \"socket hang up\"', async () => {\r\n        const baseURL = `http://localhost:3000`;\r\n        await axios.get('/1', {baseURL, timeout: 1000});\r\n        await axios.get(`/wait`, {baseURL, timeout: 0});\r\n    }, 15000);\r\n});\r\n```\r\n\r\n### Code snippet\r\n\r\n_No response_\r\n\r\n### Expected behavior\r\n\r\n1. \"socket hang up\" is misleading because it indicates the server closed the connection (in this bug the opposite is true)\r\n2. One would not expect that a timeout would keep running after a request has completed. This is a (quite major IMO) footgun.\r\n\r\n### Axios Version\r\n\r\n0.22.0 - 1.6.2\r\n\r\n### Adapter Version\r\n\r\nHTTP\r\n\r\n### Browser\r\n\r\n_No response_\r\n\r\n### Browser Version\r\n\r\n_No response_\r\n\r\n### Node.js Version\r\n\r\n20.9.0\r\n\r\n### OS\r\n\r\nOSX 14\r\n\r\n### Additional Library Versions\r\n\r\n_No response_\r\n\r\n### Additional context/Screenshots\r\n\r\n<img width=\"1456\" alt=\"tcpdump\" src=\"https://github.com/axios/axios/assets/100387231/a64c6544-4551-46ad-bb3e-1d9a6e9102b6\">\r\n\n", "hints_text": "We're also affected by this bug.\nCheers! I am affected with same bug, but can only reproduce it at Node 20.10, fallback to Node 18.18 works fine.\nThe cause of this issue is the way `follow-redirects` implements timeout. It has problems when dealing with keep-alive connections. A simple fix is to remove the `timeout` event handler when the request finishes, but I'm not sure this will work for all use-cases, as that library is mostly geared towards earlier node versions.\nSame issue here. Is there any workaround except a dumb retry?\n> Same issue here. Is there any workaround except a dumb retry?\r\n\r\n@NaZaRKIN123 Something like this would work:\r\n\r\n```typescript\r\naxios.defaults.httpAgent = new Agent({ keepAlive: false });\r\n```\r\n\r\n\nI can confirm that the workaround provided by @snarky-puppy worked for us \ud83d\ude4f\nThanks for the detail investigation. The keepAlive is needed on my project in order to reduce latency\r\nIn case we disable `follow-redirects`, would that be solved?\n+1\n+1\n+1\n+1\n> Cheers! I am affected with same bug, but can only reproduce it at Node 20.10, fallback to Node 18.18 works fine.\r\n\r\nThis is because of #6536. Short summary: Node.js changed its default Keep-Alive behavior after Node.js 18.\nI try following code in next.js _app.tsx, but not worked:\r\n\r\n```typescript\r\n// _app.tsx\r\nif (typeof window === 'undefined') {\r\n  /**\r\n   * @see https://github.com/axios/axios/issues/6113#issuecomment-1909291937\r\n   */\r\n  async function fixAxiosKeepAlive() {\r\n    const { default: axios } = await import('axios');\r\n    const { Agent } = await import('https');\r\n    axios.defaults.httpAgent = new Agent({ keepAlive: false });\r\n  }\r\n  fixAxiosKeepAlive();\r\n}\r\n```\r\n\r\nBecause of this issue, we have to revert from node 20 to 18, or we may try to remove the axios from our project. \n> ```ts\r\n> axios.defaults.httpsAgent = new Agent({ keepAlive: false });\r\n> ```\r\n@tjx666 you should replace `httpsAgent` (and `httpAgent` too if you use http, but it's a different class)\r\n\n+1\n+1\n+1\n+1\n+1\nAs I understand the issue is cause by a difference of default value between nodejs >= 20 and axios using follow-redirects.\r\nSo why we dont set up on node_modules/axios/dist/node/axios.cjs (I know its not the right place, the right place is near defaults into lib/defaults/index.js) a default value for matching default configuration of nodejs like this.\r\n\r\n```\r\n3002     if (config.insecureHTTPParser) {\r\n3003       options.insecureHTTPParser = config.insecureHTTPParser;\r\n3004     }\r\n\r\n3005     if (!options.agents.http) {                                                                              \r\n3006       options.agents.http = new http.Agent({ keepAlive: true, scheduling: 'lifo', timeout: 5000 });      \r\n3007       options.agents.https = new https.Agent({ keepAlive: true, scheduling: 'lifo', timeout: 5000 });\r\n3008     }\r\n\r\n```\r\n in this case if no agents are provide we will use agent by default with keepalive = true?\r\n\r\nI know that I can add for settings this default on my code, but I have to update many service, So I am wondering why this is not do on axios.\r\n\r\n```\r\naxios.defaults.httpAgent = new http.Agent({ keepAlive: true, scheduling: 'lifo', timeout: 5000 });\r\naxios.defaults.httpsAgent = new https.Agent({ keepAlive: true, scheduling: 'lifo', timeout: 5000 });\r\n```\r\n\r\nUsing \"axios-retry\" or \"node-fetch\" is not really for me a workaround, \r\n\r\n- retry will multiply call for nothing\r\n- and node-fetch is forget completely axios.\r\n\r\nUpdating all my code is a shame.\r\n\r\n\r\n\r\n\r\n\nI decide to never use axios because this serious issue\nsame thing for me, I took the opportunity to switch to native `fetch`.\nby doing like this its works like a charm\r\n\r\n```\r\ndiff --git a/lib/adapters/http.js b/lib/adapters/http.js\r\nindex da0a42d..6bd82a3 100755\r\n--- a/lib/adapters/http.js\r\n+++ b/lib/adapters/http.js\r\n@@ -413,7 +413,7 @@ export default isHttpAdapterSupported && function httpAdapter(config) {\r\n       path,\r\n       method: method,\r\n       headers: headers.toJSON(),\r\n-      agents: { http: config.httpAgent, https: config.httpsAgent },\r\n+      agents: { http: typeof config.httpAgent === 'function' ? config.httpAgent(http) : config.httpAgent, https: typeof config.httpsAgent === 'function' ? config.httpsAgent(https) : config.httpsAgent },\r\n       auth,\r\n       protocol,\r\n       family,\r\n@@ -434,7 +434,7 @@ export default isHttpAdapterSupported && function httpAdapter(config) {\r\n \r\n     let transport;\r\n     const isHttpsRequest = isHttps.test(options.protocol);\r\n-    options.agent = isHttpsRequest ? config.httpsAgent : config.httpAgent;\r\n+    options.agent = isHttpsRequest ? (typeof config.httpsAgent === 'function' ? config.httpsAgent(https) : config.httpsAgent) : (typeof config.httpAgent === 'function' ? config.httpAgent(http) : config.httpAgent);\r\n     if (config.transport) {\r\n       transport = config.transport;\r\n     } else if (config.maxRedirects === 0) {\r\ndiff --git a/lib/defaults/index.js b/lib/defaults/index.js\r\nindex e543fea..7e9782e 100644\r\n--- a/lib/defaults/index.js\r\n+++ b/lib/defaults/index.js\r\n@@ -151,7 +151,10 @@ const defaults = {\r\n       'Accept': 'application/json, text/plain, */*',\r\n       'Content-Type': undefined\r\n     }\r\n-  }\r\n+  },\r\n+\r\n+  httpAgent: (http) => new http.Agent({ keepAlive: true, scheduling: 'lifo', timeout: 5000 }),\r\n+  httpsAgent: (https) => new https.Agent({ keepAlive: true, scheduling: 'lifo', timeout: 5000 })\r\n };\r\n \r\n utils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\r\n\r\n```\r\nThe idea is to setup defaut agent as nodejs do since version 20\r\n\nwill start looking into how we can fix this\nsame issue\nHello, just find out the same issue was causing a socket hangup today. Fix from @snarky-puppy solved the issue.\r\n\r\nI think a lot of people is guessing if should switch to a native solution based on what's happening here.\nany updates on this guys?\n> will start looking into how we can fix this\n\nHello Guys, how are you? Do you have updates?\n> > Same issue here. Is there any workaround except a dumb retry?\n> \n> [@NaZaRKIN123](https://github.com/NaZaRKIN123) Something like this would work:\n> \n> axios.defaults.httpAgent = new Agent({ keepAlive: false });\n\n@NaZaRKIN123 Why would this fix it if the default is a disabled keepAlive? \ud83e\udd14  \n\nInterestingly, I tried it for some endpoints and haven't got any new alerts since then. But I cannot reason or justify this change yet \ud83e\udd14  Both [Axios](https://github.com/axios/axios/blob/32c7bcc0f233285ba27dec73a4b1e81fb7a219b3/README.md?plain=1#L546-L550) and [Node's HTTP agent](https://nodejs.org/api/http.html#new-agentoptions) have the keepAlive disabled by default.\n> Why would this fix it if the default is a disabled keepAlive? \n\n@7onn This problem is caused by the fact that in node v20 [they turned on the keep-alive option on the default HTTP agent](https://github.com/nodejs/node/blob/a7f648c8ba77b542dff20e717ab3e005425fa1a6/lib/_http_agent.js#L546), while their default scheduling algorithm has a fairly high probability of race conditions, in which the client may get a nearly expired socket that has actually already been closed on the server side, which causes a socket usage error. \n\n```js\nconst instance = axios.create({\n  httpAgent: new http.Agent({ keepAlive: false}),\n  httpsAgent: new https.Agent({ keepAlive: false})\n});\n```\nIt would be hard to fix anything from the Axios side, since this is a problem inside the node.js, unless you write your own UserAgent and scheduler, which would be useless as soon as the node maintainers fixed this problem, so it was logical to just wait and manually disable `keepAlive`.\nFrom what I can see in the node.js codebase, [5 months ago they finally pushed a fix](https://github.com/nodejs/node/blame/5c83957601e16137c0ef925191435199bb8d40e1/lib/_http_agent.js#L482C2-L490) to provide a hard-coded 1000ms safety time window, which I believe should solve the problem in most cases.\n\n\n\n\n\n\nI use it actually for react native and experimenting that same delay for continuous request, are any way tho change that of keepAlive on axios for react native?\nclosing as per @DigitalBrainJS comment, will add this to be documented\nas of 2025/9/15,  axios 0.22.0+  {keepAlive: false}  do not work for me.  \nBut 0.21.4 is working.\nThe api is just about 10 seconds, not too long,  so tricky\n\n\n-----\nas of 2025/9/17, this should work.  I my project,  httpsAgent is set in another request which is not set keepAlive:false,   after reset all httpsAgent  httpAgent, It works for http request.  but not for https request.\n\n-----\nthis bug have existed for many years,  use fetch instead finally. This should be axios and nodejs compatibility bug. Upgrate to nodejs v20.19.5 still not work.\n@DigitalBrainJS According to [this PR](https://github.com/nodejs/node/pull/55170) the [\"fix\"](https://github.com/nodejs/node/blame/5c83957601e16137c0ef925191435199bb8d40e1/lib/_http_agent.js#L482C2-L490) in node you mentioned made it into node 20.18.0. We are running on node 20.18.0 with axios 1.9.0 and still receive a lot of ECONNERR and \"socket hang up\" errors in production. \n\nSince axios is supporting `fetch` since 1.7.0 it might be best option to switch the adapter to `fetch`, which then uses `undici` under the hood in node which according to [this thread](https://github.com/nodejs/node/issues/47130) does not have such issues.\n\nWe are currently in the process of rolling this out to our production environment. So I will report in a few weeks whether this switch fixed our problems. \n@yss14 thanks, please update us when you are ready!\n@jasonsaayman I can already give you an update on this, since the change is now rolled out for a few days on our production environment.\nUnfortunately, this didn't solve the problem for use. The errors now reported by Sentry turned into undici specific socket errors `other side closed`. So it seems like we have a different problem in our microservice infrastructure which I now have to investigate further.", "created_at": "2025-11-03T22:52:03Z"}
{"repo": "axios/axios", "pull_number": 7203, "instance_id": "axios__axios.ef36347f.7203", "issue_numbers": [], "base_commit": "ef36347f", "patch": "diff --git a/README.md b/README.md\nindex e9d886e00c..d81981f630 100644\n--- a/README.md\n+++ b/README.md\n@@ -5,11 +5,8 @@\n </td></tr><tr width=\"33.333333333333336%\"><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://www.descope.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;referral&amp;utm_campaign&#x3D;axios-oss-sponsorship\" style=\"padding: 10px; display: inline-block\" target=\"_blank\"> <picture> <source width=\"200px\" height=\"52px\" media=\"(prefers-color-scheme: dark)\" srcset=\"https://axios-http.com/assets/sponsors/descope_white.png\"> <img width=\"200px\" height=\"52px\" src=\"https://axios-http.com/assets/sponsors/descope.png\" alt=\"Descope\"/> </picture> </a> <p align=\"center\" title=\"Hi, we&#x27;re Descope! We are building something in the authentication space for app developers and can\u2019t wait to place it in your hands.\">Hi, we&#x27;re Descope! We are building something in the authentication space for app developers and...</p> <p align=\"center\"> <a href=\"https://www.descope.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;referral&amp;utm_campaign&#x3D;axios-oss-sponsorship\" target=\"_blank\"><b>Website</b></a> | <a href=\"https://docs.descope.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;referral&amp;utm_campaign&#x3D;axios-oss-sponsorship\" target=\"_blank\"><b>Docs</b></a> | <a href=\"https://www.descope.com/community?utm_source&#x3D;axios&amp;utm_medium&#x3D;referral&amp;utm_campaign&#x3D;axios-oss-sponsorship\" target=\"_blank\"><b>Community</b></a> </p>\n </td><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://route4me.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;sponsorlist&amp;utm_campaign&#x3D;sponsorship\" style=\"padding: 10px; display: inline-block\" target=\"_blank\"> <picture> <source width=\"200px\" height=\"51px\" media=\"(prefers-color-scheme: dark)\" srcset=\"https://axios-http.com/assets/sponsors/route4me_white.png\"> <img width=\"200px\" height=\"51px\" src=\"https://axios-http.com/assets/sponsors/route4me.png\" alt=\"Route4Me\"/> </picture> </a> <p align=\"center\" title=\"Best Route Planning And Route Optimization Software\">Best Route Planning And Route Optimization Software</p> <p align=\"center\"> <a href=\"https://route4me.com/platform/route-optimization-software?utm_source&#x3D;axios&amp;utm_medium&#x3D;readme_sponsorlist&amp;utm_campaign&#x3D;sponsorship\" target=\"_blank\"><b>Explore</b></a> | <a href=\"https://route4me.com/platform/marketplace/pricing?utm_source&#x3D;axios&amp;utm_medium&#x3D;readme_sponsorlist&amp;utm_campaign&#x3D;sponsorship\" target=\"_blank\"><b>Free Trial</b></a> | <a href=\"https://route4me.com/contact?utm_source&#x3D;axios&amp;utm_medium&#x3D;readme_sponsorlist&amp;utm_campaign&#x3D;sponsorship\" target=\"_blank\"><b>Contact</b></a> </p>\n </td><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://buzzoid.com/buy-instagram-followers/?utm_source&#x3D;axios&amp;utm_medium&#x3D;sponsorlist&amp;utm_campaign&#x3D;sponsorship\" style=\"padding: 10px; display: inline-block\" target=\"_blank\"> <img width=\"62px\" height=\"70px\" src=\"https://axios-http.com/assets/sponsors/opencollective/e1625cb54e10ee40180c99d1495a462e9d6664a4.png\" alt=\"Buzzoid - Buy Instagram Followers\"/> </a> <p align=\"center\" title=\"At Buzzoid, you can buy Instagram followers quickly, safely, and easily with just a few clicks. Rated world&#x27;s #1 IG service since 2012.\">At Buzzoid, you can buy Instagram followers quickly, safely, and easily with just a few clicks. Rate...</p> <p align=\"center\"> <a href=\"https://buzzoid.com/buy-instagram-followers/?utm_source&#x3D;axios&amp;utm_medium&#x3D;readme_sponsorlist&amp;utm_campaign&#x3D;sponsorship\" target=\"_blank\"><b>buzzoid.com</b></a> </p>\n-</td></tr><tr width=\"33.333333333333336%\"><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://www.famety.net/?utm_source&#x3D;axios&amp;utm_medium&#x3D;sponsorlist&amp;utm_campaign&#x3D;sponsorship\" style=\"padding: 10px; display: inline-block\" target=\"_blank\"> <img width=\"70px\" height=\"70px\" src=\"https://axios-http.com/assets/sponsors/opencollective/56645c65d4bad0ab84265e02430d19d64afde927.png\" alt=\"Famety - Buy Instagram Followers\"/> </a> <p align=\"center\" title=\"At Famety, you can grow your social media following quickly, safely, and easily with just a few clicks. Rated the world\u2019s #1 social media service since 2013.\">At Famety, you can grow your social media following quickly, safely, and easily with just a few clic...</p> <p align=\"center\"> <a href=\"https://www.famety.net/?utm_source&#x3D;axios&amp;utm_medium&#x3D;readme_sponsorlist&amp;utm_campaign&#x3D;sponsorship\" target=\"_blank\"><b>www.famety.net</b></a> </p>\n-</td><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://poprey.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;sponsorlist&amp;utm_campaign&#x3D;sponsorship\" style=\"padding: 10px; display: inline-block\" target=\"_blank\"> <img width=\"70px\" height=\"70px\" src=\"https://axios-http.com/assets/sponsors/opencollective/e699ec99f7df3a203ddbc49d3c7712a907e628ea.png\" alt=\"Poprey - Buy Instagram Likes\"/> </a> <p align=\"center\" title=\"Buy Instagram Likes\">Buy Instagram Likes</p> <p align=\"center\"> <a href=\"https://poprey.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;readme_sponsorlist&amp;utm_campaign&#x3D;sponsorship\" target=\"_blank\"><b>poprey.com</b></a> </p>\n+</td></tr><tr width=\"33.333333333333336%\"><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://poprey.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;sponsorlist&amp;utm_campaign&#x3D;sponsorship\" style=\"padding: 10px; display: inline-block\" target=\"_blank\"> <img width=\"70px\" height=\"70px\" src=\"https://axios-http.com/assets/sponsors/opencollective/e699ec99f7df3a203ddbc49d3c7712a907e628ea.png\" alt=\"Poprey - Buy Instagram Likes\"/> </a> <p align=\"center\" title=\"Buy Instagram Likes\">Buy Instagram Likes</p> <p align=\"center\"> <a href=\"https://poprey.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;readme_sponsorlist&amp;utm_campaign&#x3D;sponsorship\" target=\"_blank\"><b>poprey.com</b></a> </p>\n </td><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://requestly.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;sponsorlist&amp;utm_campaign&#x3D;sponsorship\" style=\"padding: 10px; display: inline-block\" target=\"_blank\"> <img width=\"71px\" height=\"70px\" src=\"https://axios-http.com/assets/sponsors/opencollective/16450b4dc0deb9dab5a511bf2bc8b8b4ac33412f.png\" alt=\"Requestly\"/> </a> <p align=\"center\" title=\"A lightweight open-source API Development, Testing &amp; Mocking platform\">A lightweight open-source API Development, Testing &amp; Mocking platform</p> <p align=\"center\"> <a href=\"https://requestly.com/?utm_source&#x3D;axios&amp;utm_medium&#x3D;readme_sponsorlist&amp;utm_campaign&#x3D;sponsorship\" target=\"_blank\"><b>requestly.com</b></a> </p>\n-</td></tr><tr width=\"33.333333333333336%\"><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://opencollective.com/axios/contribute\" target=\"_blank\" >\ud83d\udc9c Become a sponsor</a>\n-</td><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://opencollective.com/axios/contribute\" target=\"_blank\" >\ud83d\udc9c Become a sponsor</a>\n </td><td align=\"center\" width=\"33.333333333333336%\"> <a href=\"https://opencollective.com/axios/contribute\" target=\"_blank\" >\ud83d\udc9c Become a sponsor</a>\n </td></tr></table>\n \n", "test_patch": "", "problem_statement": "", "hints_text": "", "created_at": "2025-11-02T01:30:42Z"}
{"repo": "axios/axios", "pull_number": 7202, "instance_id": "axios__axios.ef36347f.7202", "issue_numbers": [], "base_commit": "ef36347f", "patch": "diff --git a/lib/adapters/http.js b/lib/adapters/http.js\nindex 4d2670cb7a..524c278505 100755\n--- a/lib/adapters/http.js\n+++ b/lib/adapters/http.js\n@@ -65,9 +65,9 @@ class Http2Sessions {\n       sessionTimeout: 1000\n     }, options);\n \n-    let authoritySessions;\n+    let authoritySessions = this.sessions[authority];\n \n-    if ((authoritySessions = this.sessions[authority])) {\n+    if (authoritySessions) {\n       let len = authoritySessions.length;\n \n       for (let i = 0; i < len; i++) {\n@@ -93,11 +93,12 @@ class Http2Sessions {\n \n       while (i--) {\n         if (entries[i][0] === session) {\n-          entries.splice(i, 1);\n           if (len === 1) {\n             delete this.sessions[authority];\n-            return;\n+          } else {\n+            entries.splice(i, 1);\n           }\n+          return;\n         }\n       }\n     };\n@@ -136,12 +137,12 @@ class Http2Sessions {\n \n     session.once('close', removeSession);\n \n-    let entries = this.sessions[authority], entry = [\n-      session,\n-      options\n-    ];\n+    let entry = [\n+        session,\n+        options\n+      ];\n \n-    entries ? this.sessions[authority].push(entry) : authoritySessions =  this.sessions[authority] = [entry];\n+    authoritySessions ? authoritySessions.push(entry) : authoritySessions =  this.sessions[authority] = [entry];\n \n     return session;\n   }\n", "test_patch": "", "problem_statement": "", "hints_text": "", "created_at": "2025-10-31T21:54:02Z"}
{"repo": "axios/axios", "pull_number": 7201, "instance_id": "axios__axios.ef36347f.7201", "issue_numbers": ["7200"], "base_commit": "ef36347f", "patch": "diff --git a/README.md b/README.md\nindex e9d886e00c..15bf7256ab 100644\n--- a/README.md\n+++ b/README.md\n@@ -816,6 +816,41 @@ axios.interceptors.request.use(function (config) {\n \n > **Note:** options parameter(having `synchronous` and `runWhen` properties) is only supported for request interceptors at the moment.\n \n+### Interceptor Execution Order\n+\n+**Important:** Interceptors have different execution orders depending on their type!\n+\n+Request interceptors are executed in **reverse order** (LIFO - Last In, First Out). This means the _last_ interceptor added is executed **first**.\n+\n+Response interceptors are executed in the **order they were added** (FIFO - First In, First Out). This means the _first_ interceptor added is executed **first**.\n+\n+Example:\n+\n+```js\n+const instance = axios.create();\n+\n+const interceptor = (id) => (base) => {\n+  console.log(id);\n+  return base;\n+}\n+\n+instance.interceptors.request.use(interceptor('Request Interceptor 1'));\n+instance.interceptors.request.use(interceptor('Request Interceptor 2'));\n+instance.interceptors.request.use(interceptor('Request Interceptor 3'));\n+instance.interceptors.response.use(interceptor('Response Interceptor 1'));\n+instance.interceptors.response.use(interceptor('Response Interceptor 2'));\n+instance.interceptors.response.use(interceptor('Response Interceptor 3'));\n+\n+// Console output:\n+// Request Interceptor 3\n+// Request Interceptor 2\n+// Request Interceptor 1\n+// [HTTP request is made]\n+// Response Interceptor 1\n+// Response Interceptor 2\n+// Response Interceptor 3\n+```\n+\n ### Multiple Interceptors\n \n Given you add multiple response interceptors\n", "test_patch": "", "problem_statement": "Clarify interceptors execution order\n### Section/Content To Improve\n\nhttps://github.com/codenomnom/axios-interceptors-docs/blob/v1.x/README.md#interceptors\n\n---\nSummary\n\nThe current documentation does not clearly explain that **request interceptors execute in reverse order** (LIFO) while **response interceptors execute in the order they were added** (FIFO). I find this utterly critical to inform, as it took me quite a while to debug a dynamically added interceptors in production \ud83d\ude05 \n\nI've researched this and came to the conclusion this is intended behavior.\nThe implementation in `lib/core/Axios.js` (lines ~130-140) explicitly uses different array methods for the two types of interceptors:\n\n- **Request interceptors**: Use `unshift()` \u2192 LIFO (Last In, First Out / reverse order)\n- **Response interceptors**: Use `push()` \u2192 FIFO (First In, First Out / normal order)\n\nThe test suite even includes a comment acknowledging this behavior (source: `test/specs/interceptors.spec.js`):\n```javascript\n/* request interceptors have a reversed execution order */\n```\n\n\n\n\n### Suggested Improvement\n\nI'm preparing a PR to:\n1. Add a clear \"Execution Order\" subsection to the Interceptors documentation\n2. Include code examples showing the exact execution flow\n\n### Relevant File(s)\n\n```bash\nREADME.md\n```\n", "hints_text": "", "created_at": "2025-10-31T09:14:00Z"}
{"repo": "axios/axios", "pull_number": 7198, "instance_id": "axios__axios.ef36347f.7198", "issue_numbers": [], "base_commit": "ef36347f", "patch": "diff --git a/CODE_OF_CONDUCT.md b/CODE_OF_CONDUCT.md\nindex 56fe7378a9..7b6b9817fb 100644\n--- a/CODE_OF_CONDUCT.md\n+++ b/CODE_OF_CONDUCT.md\n@@ -2,83 +2,35 @@\n \n ## Our Pledge\n \n-We as members, contributors, and leaders pledge to make participation in our community a harassment-free experience for everyone, regardless of age, body size, visible or invisible disability, ethnicity, sex characteristics, gender identity and expression, level of experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, or sexual identity and orientation.\n-\n-We pledge to act and interact in ways that contribute to an open, welcoming, diverse, inclusive, and healthy community.\n+We, as contributors and community members, are committed to providing a welcoming, safe, and harassment-free environment for everyone.  \n+We celebrate diversity and inclusivity regardless of age, body size, disability, ethnicity, gender identity or expression, experience level, education, nationality, race, religion, sexual orientation, or any other personal characteristic.\n \n ## Our Standards\n \n-Examples of behavior that contributes to a positive environment for our community include:\n-\n-* Demonstrating empathy and kindness toward other people\n-* Being respectful of differing opinions, viewpoints, and experiences\n-* Giving and gracefully accepting constructive feedback\n-* Accepting responsibility and apologizing to those affected by our mistakes, and learning from the experience\n-* Focusing on what is best not just for us as individuals, but for the overall community\n-\n-Examples of unacceptable behavior include:\n-\n-* The use of sexualized language or imagery, and sexual attention or advances of any kind\n-* Trolling, insulting or derogatory comments, and personal or political attacks\n-* Public or private harassment\n-* Publishing others' private information, such as a physical or email address, without their explicit permission\n-* Other conduct which could reasonably be considered inappropriate in a professional setting\n-\n-## Enforcement Responsibilities\n-\n-Community leaders are responsible for clarifying and enforcing our standards of acceptable behavior and will take appropriate and fair corrective action in response to any behavior that they deem inappropriate, threatening, offensive, or harmful.\n+Examples of positive behavior include:\n+* Showing empathy and kindness toward others  \n+* Being respectful of different opinions and experiences  \n+* Accepting feedback gracefully and learning from it  \n+* Taking responsibility for mistakes and offering sincere apologies  \n \n-Community leaders have the right and responsibility to remove, edit, or reject comments, commits, code, wiki edits, issues, and other contributions that are not aligned to this Code of Conduct, and will communicate reasons for moderation decisions when appropriate.\n-\n-## Scope\n-\n-This Code of Conduct applies within all community spaces, and also applies when an individual is officially representing the community in public spaces. Examples of representing our community include using an official e-mail address, posting via an official social media account, or acting as an appointed representative at an online or offline event.\n+Unacceptable behaviors include:\n+* Use of sexualized language, imagery, or advances  \n+* Personal attacks, trolling, or insulting comments  \n+* Publishing private information (such as email or address) without permission  \n+* Any other conduct that would be considered inappropriate in a professional setting  \n \n ## Enforcement\n \n-Instances of abusive, harassing, or otherwise unacceptable behavior may be reported to the community leaders responsible for enforcement at [Jason Saayman](jasonsaayman@gmail.com). All complaints will be reviewed and investigated promptly and fairly.\n-\n-All community leaders are obligated to respect the privacy and security of the reporter of any incident.\n+Instances of unacceptable behavior can be reported to the maintainers at [jasonsaayman@gmail.com](mailto:jasonsaayman@gmail.com).  \n+All complaints will be reviewed promptly and treated confidentially.\n \n ## Enforcement Guidelines\n \n-Community leaders will follow these Community Impact Guidelines in determining the consequences for any action they deem in violation of this Code of Conduct:\n-\n-### 1. Correction\n-\n-**Community Impact**: Use of inappropriate language or other behavior deemed unprofessional or unwelcome in the community.\n-\n-**Consequence**: A private, written warning from community leaders, providing clarity around the nature of the violation and an explanation of why the behavior was inappropriate. A public apology may be requested.\n-\n-### 2. Warning\n-\n-**Community Impact**: A violation through a single incident or series of actions.\n-\n-**Consequence**: A warning with consequences for continued behavior. No interaction with the people involved, including unsolicited interaction with those enforcing the Code of Conduct, for a specified period of time. This includes avoiding interactions in community spaces as well as external channels like social media. Violating these terms may lead to a temporary or permanent ban.\n-\n-### 3. Temporary Ban\n-\n-**Community Impact**: A serious violation of community standards, including sustained inappropriate behavior.\n-\n-**Consequence**: A temporary ban from any sort of interaction or public communication with the community for a specified period of time. No public or private interaction with the people involved, including unsolicited interaction with those enforcing the Code of Conduct, is allowed during this period. Violating these terms may lead to a permanent ban.\n-\n-### 4. Permanent Ban\n-\n-**Community Impact**: Demonstrating a pattern of violation of community standards, including sustained inappropriate behavior, harassment of an individual, or aggression toward or disparagement of classes of individuals.\n-\n-**Consequence**: A permanent ban from any sort of public interaction within the community.\n-\n-## Attribution\n-\n-This Code of Conduct is adapted from the [Contributor Covenant][homepage], version 2.1, available at [https://www.contributor-covenant.org/version/2/1/code_of_conduct.html][v2.1].\n-\n-Community Impact Guidelines were inspired by\n-[Mozilla's code of conduct enforcement ladder][Mozilla CoC].\n+1. **Correction** \u2013 A private warning and explanation of why the behavior was inappropriate.  \n+2. **Warning** \u2013 A clear warning with consequences for continued behavior.  \n+3. **Temporary Ban** \u2013 A temporary ban for repeated or severe violations.  \n+4. **Permanent Ban** \u2013 A permanent removal for repeated harassment or sustained inappropriate conduct.\n \n-For answers to common questions about this code of conduct, see the FAQ at [https://www.contributor-covenant.org/faq][FAQ]. Translations are available at [https://www.contributor-covenant.org/translations][translations].\n+---\n \n-[homepage]: https://www.contributor-covenant.org\n-[v2.1]: https://www.contributor-covenant.org/version/2/1/code_of_conduct.html\n-[Mozilla CoC]: https://github.com/mozilla/diversity\n-[FAQ]: https://www.contributor-covenant.org/faq\n-[translations]: https://www.contributor-covenant.org/translations\n+_This Code of Conduct is adapted from the [Contributor Covenant, version 2.1](https://www.contributor-covenant.org/version/2/1/code_of_conduct.html)._\n", "test_patch": "", "problem_statement": "", "hints_text": "", "created_at": "2025-10-30T00:04:17Z"}
